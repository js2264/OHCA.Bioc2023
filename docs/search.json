[
  {
    "objectID": "inst/scripts/create-data.html",
    "href": "inst/scripts/create-data.html",
    "title": "Hi-C analysis with Bioconductor<br>Package Demo<br>Bioc2023 Conference",
    "section": "",
    "text": "This snippets creates the background image on the first slide\n\n\nlibrary(fourDNData)\nlibrary(HiCExperiment)\nlibrary(HiContacts)\nlibrary(tidyverse)\nhic &lt;- import('~/.cache/R/fourDNData/4d434d8538a0_4DNFI9FVHJZQ.mcool', focus = 'chr3:98800000-117400000', resolution = 5000)\nhic &lt;- hic |&gt; detrend() \np &lt;- plotMatrix(hic, use.scores = 'detrended', scale = 'linear', limits = c(-2.5, 2.5), cmap = rainbowColors())\nggsave('figures/4DNFI9FVHJZQ_MicroC-HFFc6-Krietenstein.pdf', width = 15, height = 15)"
  },
  {
    "objectID": "LICENSE.html",
    "href": "LICENSE.html",
    "title": "MIT License",
    "section": "",
    "text": "MIT License\nCopyright (c) 2020 Sean Davis\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\nTHE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE."
  },
  {
    "objectID": "slides.html",
    "href": "slides.html",
    "title": "Package presentation",
    "section": "",
    "text": "Package presentation\n\n&lt;div id=\"quarto-navigation-envelope\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar-title\"&gt;Hi-C analysis with Bioconductor&lt;br&gt;Package Demo&lt;br&gt;Bioc2023 Conference&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-navbar-title\"&gt;Hi-C analysis with Bioconductor&lt;br&gt;Package Demo&lt;br&gt;Bioc2023 Conference&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-next\"&gt;Parsing Hi-C data in R&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-prev\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/index.html\"&gt;Welcome&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/slides.html\"&gt;Package presentation&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/parsing.html\"&gt;Parsing Hi-C data in R&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/visualizing.html\"&gt;Visualizing Hi-C data in R&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/investigating.html\"&gt;Investigating Hi-C data in R&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-int-sidebar:/interoperability.html\"&gt;Interoperability of HiCExperiment&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-left\"&gt;OHCA – Package demonstration – Bioc2023 Conference&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"footer-right\"&gt;This website was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-breadcrumbs-8862227389aa55aa74a0acc1c6ebd119\"&gt;Package presentation&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;div id=\"quarto-meta-markdown\" class=\"hidden\"&gt;\n&lt;p&gt;&lt;span class=\"hidden\" data-render-id=\"quarto-twittercardtitle\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardtitle\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-metasitename\"&gt;Hi-C analysis with Bioconductor&lt;br&gt;Package Demo&lt;br&gt;Bioc2023 Conference&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-twittercarddesc\"&gt;&lt;/span&gt; &lt;span class=\"hidden\" data-render-id=\"quarto-ogcardddesc\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;/section&gt;\n\n&lt;/main&gt; &lt;!-- /main --&gt;\n&lt;script id = \"quarto-html-after-body\" type=\"application/javascript\"&gt;\nwindow.document.addEventListener(\"DOMContentLoaded\", function (event) {\n  const toggleBodyColorMode = (bsSheetEl) =&gt; {\n    const mode = bsSheetEl.getAttribute(\"data-mode\");\n    const bodyEl = window.document.querySelector(\"body\");\n    if (mode === \"dark\") {\n      bodyEl.classList.add(\"quarto-dark\");\n      bodyEl.classList.remove(\"quarto-light\");\n    } else {\n      bodyEl.classList.add(\"quarto-light\");\n      bodyEl.classList.remove(\"quarto-dark\");\n    }\n  }\n  const toggleBodyColorPrimary = () =&gt; {\n    const bsSheetEl = window.document.querySelector(\"link#quarto-bootstrap\");\n    if (bsSheetEl) {\n      toggleBodyColorMode(bsSheetEl);\n    }\n  }\n  toggleBodyColorPrimary();  \n  const icon = \"\";\n  const anchorJS = new window.AnchorJS();\n  anchorJS.options = {\n    placement: 'right',\n    icon: icon\n  };\n  anchorJS.add('.anchored');\n  const isCodeAnnotation = (el) =&gt; {\n    for (const clz of el.classList) {\n      if (clz.startsWith('code-annotation-')) {                     \n        return true;\n      }\n    }\n    return false;\n  }\n  const clipboard = new window.ClipboardJS('.code-copy-button', {\n    text: function(trigger) {\n      const codeEl = trigger.previousElementSibling.cloneNode(true);\n      for (const childEl of codeEl.children) {\n        if (isCodeAnnotation(childEl)) {\n          childEl.remove();\n        }\n      }\n      return codeEl.innerText;\n    }\n  });\n  clipboard.on('success', function(e) {\n    // button target\n    const button = e.trigger;\n    // don't keep focus\n    button.blur();\n    // flash \"checked\"\n    button.classList.add('code-copy-button-checked');\n    var currentTitle = button.getAttribute(\"title\");\n    button.setAttribute(\"title\", \"Copied!\");\n    let tooltip;\n    if (window.bootstrap) {\n      button.setAttribute(\"data-bs-toggle\", \"tooltip\");\n      button.setAttribute(\"data-bs-placement\", \"left\");\n      button.setAttribute(\"data-bs-title\", \"Copied!\");\n      tooltip = new bootstrap.Tooltip(button, \n        { trigger: \"manual\", \n          customClass: \"code-copy-button-tooltip\",\n          offset: [0, -8]});\n      tooltip.show();    \n    }\n    setTimeout(function() {\n      if (tooltip) {\n        tooltip.hide();\n        button.removeAttribute(\"data-bs-title\");\n        button.removeAttribute(\"data-bs-toggle\");\n        button.removeAttribute(\"data-bs-placement\");\n      }\n      button.setAttribute(\"title\", currentTitle);\n      button.classList.remove('code-copy-button-checked');\n    }, 1000);\n    // clear code selection\n    e.clearSelection();\n  });\n  function tippyHover(el, contentFn) {\n    const config = {\n      allowHTML: true,\n      content: contentFn,\n      maxWidth: 500,\n      delay: 100,\n      arrow: false,\n      appendTo: function(el) {\n          return el.parentElement;\n      },\n      interactive: true,\n      interactiveBorder: 10,\n      theme: 'quarto',\n      placement: 'bottom-start'\n    };\n    window.tippy(el, config); \n  }\n  const noterefs = window.document.querySelectorAll('a[role=\"doc-noteref\"]');\n  for (var i=0; i&lt;noterefs.length; i++) {\n    const ref = noterefs[i];\n    tippyHover(ref, function() {\n      // use id or data attribute instead here\n      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');\n      try { href = new URL(href).hash; } catch {}\n      const id = href.replace(/^#\\/?/, \"\");\n      const note = window.document.getElementById(id);\n      return note.innerHTML;\n    });\n  }\n      let selectedAnnoteEl;\n      const selectorForAnnotation = ( cell, annotation) =&gt; {\n        let cellAttr = 'data-code-cell=\"' + cell + '\"';\n        let lineAttr = 'data-code-annotation=\"' +  annotation + '\"';\n        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';\n        return selector;\n      }\n      const selectCodeLines = (annoteEl) =&gt; {\n        const doc = window.document;\n        const targetCell = annoteEl.getAttribute(\"data-target-cell\");\n        const targetAnnotation = annoteEl.getAttribute(\"data-target-annotation\");\n        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));\n        const lines = annoteSpan.getAttribute(\"data-code-lines\").split(\",\");\n        const lineIds = lines.map((line) =&gt; {\n          return targetCell + \"-\" + line;\n        })\n        let top = null;\n        let height = null;\n        let parent = null;\n        if (lineIds.length &gt; 0) {\n            //compute the position of the single el (top and bottom and make a div)\n            const el = window.document.getElementById(lineIds[0]);\n            top = el.offsetTop;\n            height = el.offsetHeight;\n            parent = el.parentElement.parentElement;\n          if (lineIds.length &gt; 1) {\n            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);\n            const bottom = lastEl.offsetTop + lastEl.offsetHeight;\n            height = bottom - top;\n          }\n          if (top !== null && height !== null && parent !== null) {\n            // cook up a div (if necessary) and position it \n            let div = window.document.getElementById(\"code-annotation-line-highlight\");\n            if (div === null) {\n              div = window.document.createElement(\"div\");\n              div.setAttribute(\"id\", \"code-annotation-line-highlight\");\n              div.style.position = 'absolute';\n              parent.appendChild(div);\n            }\n            div.style.top = top - 2 + \"px\";\n            div.style.height = height + 4 + \"px\";\n            let gutterDiv = window.document.getElementById(\"code-annotation-line-highlight-gutter\");\n            if (gutterDiv === null) {\n              gutterDiv = window.document.createElement(\"div\");\n              gutterDiv.setAttribute(\"id\", \"code-annotation-line-highlight-gutter\");\n              gutterDiv.style.position = 'absolute';\n              const codeCell = window.document.getElementById(targetCell);\n              const gutter = codeCell.querySelector('.code-annotation-gutter');\n              gutter.appendChild(gutterDiv);\n            }\n            gutterDiv.style.top = top - 2 + \"px\";\n            gutterDiv.style.height = height + 4 + \"px\";\n          }\n          selectedAnnoteEl = annoteEl;\n        }\n      };\n      const unselectCodeLines = () =&gt; {\n        const elementsIds = [\"code-annotation-line-highlight\", \"code-annotation-line-highlight-gutter\"];\n        elementsIds.forEach((elId) =&gt; {\n          const div = window.document.getElementById(elId);\n          if (div) {\n            div.remove();\n          }\n        });\n        selectedAnnoteEl = undefined;\n      };\n      // Attach click handler to the DT\n      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');\n      for (const annoteDlNode of annoteDls) {\n        annoteDlNode.addEventListener('click', (event) =&gt; {\n          const clickedEl = event.target;\n          if (clickedEl !== selectedAnnoteEl) {\n            unselectCodeLines();\n            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');\n            if (activeEl) {\n              activeEl.classList.remove('code-annotation-active');\n            }\n            selectCodeLines(clickedEl);\n            clickedEl.classList.add('code-annotation-active');\n          } else {\n            // Unselect the line\n            unselectCodeLines();\n            clickedEl.classList.remove('code-annotation-active');\n          }\n        });\n      }\n  const findCites = (el) =&gt; {\n    const parentEl = el.parentElement;\n    if (parentEl) {\n      const cites = parentEl.dataset.cites;\n      if (cites) {\n        return {\n          el,\n          cites: cites.split(' ')\n        };\n      } else {\n        return findCites(el.parentElement)\n      }\n    } else {\n      return undefined;\n    }\n  };\n  var bibliorefs = window.document.querySelectorAll('a[role=\"doc-biblioref\"]');\n  for (var i=0; i&lt;bibliorefs.length; i++) {\n    const ref = bibliorefs[i];\n    const citeInfo = findCites(ref);\n    if (citeInfo) {\n      tippyHover(citeInfo.el, function() {\n        var popup = window.document.createElement('div');\n        citeInfo.cites.forEach(function(cite) {\n          var citeDiv = window.document.createElement('div');\n          citeDiv.classList.add('hanging-indent');\n          citeDiv.classList.add('csl-entry');\n          var biblioDiv = window.document.getElementById('ref-' + cite);\n          if (biblioDiv) {\n            citeDiv.innerHTML = biblioDiv.innerHTML;\n          }\n          popup.appendChild(citeDiv);\n        });\n        return popup.innerHTML;\n      });\n    }\n  }\n});\n&lt;/script&gt;\n&lt;/div&gt; &lt;!-- /content --&gt;\n&lt;footer class=\"footer\"&gt;\n  &lt;div class=\"nav-footer\"&gt;\n    &lt;div class=\"nav-footer-left\"&gt;\n      &lt;div class='footer-contents'&gt;OHCA – Package demonstration – Bioc2023 Conference\n&lt;/div&gt;  \n    &lt;/div&gt;   \n    &lt;div class=\"nav-footer-center\"&gt;\n      &nbsp;\n    &lt;/div&gt;\n    &lt;div class=\"nav-footer-right\"&gt;\n      &lt;div class='footer-contents'&gt;This website was built with &lt;a href=\"https://quarto.org/\"&gt;Quarto&lt;/a&gt;.\n&lt;/div&gt;  \n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/footer&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Welcome",
    "section": "",
    "text": "This package is used to support the OHCA package demonstration at the Bioconductor Conference 2023.\n\n\n\n\n\n\n📚 The OHCA book is the main documentation, and is available here.\n\n\n\n\n\n\n\nThis is a package demonstration for the OHCA ecosystem, including the following packages :\n\nHiCool\nHiCExperiment\nHiContacts\nfourDNData\n\n\nFamiliarity with the tidyverse syntax;\nFamiliarity with the GenomicRanges class;\nBasic understanding of Hi-C principles\n\nFor more information on Hi-C experimental approach and principles, read OHCA book first chapter.\n\n\n\nActivity\nTime\n\n\n\nIntroduction to Hi-C\n10m\n\n\nOHCA ecosystem\n10m\n\n\nDemonstration with real data\n20m\n\n\nWrapping up\n5m\n\n\n\nTo quickly use the package Docker image:\ndocker run -it -e PASSWORD=OHCA -p 8787:8787 ghcr.io/js2264/ohca:bioc_RELEASE_3_17\nOnce running, navigate to http://localhost:8787/ and then login with rstudio:OHCA."
  },
  {
    "objectID": "index.html#description",
    "href": "index.html#description",
    "title": "Welcome",
    "section": "",
    "text": "This is a package demonstration for the OHCA ecosystem, including the following packages :\n\nHiCool\nHiCExperiment\nHiContacts\nfourDNData"
  },
  {
    "objectID": "index.html#pre-requisites",
    "href": "index.html#pre-requisites",
    "title": "Welcome",
    "section": "",
    "text": "Familiarity with the tidyverse syntax;\nFamiliarity with the GenomicRanges class;\nBasic understanding of Hi-C principles\n\nFor more information on Hi-C experimental approach and principles, read OHCA book first chapter."
  },
  {
    "objectID": "index.html#time-outline",
    "href": "index.html#time-outline",
    "title": "Welcome",
    "section": "",
    "text": "Activity\nTime\n\n\n\nIntroduction to Hi-C\n10m\n\n\nOHCA ecosystem\n10m\n\n\nDemonstration with real data\n20m\n\n\nWrapping up\n5m"
  },
  {
    "objectID": "index.html#docker-image",
    "href": "index.html#docker-image",
    "title": "Welcome",
    "section": "",
    "text": "To quickly use the package Docker image:\ndocker run -it -e PASSWORD=OHCA -p 8787:8787 ghcr.io/js2264/ohca:bioc_RELEASE_3_17\nOnce running, navigate to http://localhost:8787/ and then login with rstudio:OHCA."
  },
  {
    "objectID": "interoperability.html",
    "href": "interoperability.html",
    "title": "Interoperability of HiCExperiment",
    "section": "",
    "text": "hic &lt;- import(\n    CoolFile(HiContactsData('yeast_wt', 'mcool')), \n    focus = 'II', \n    resolution = 2000\n)\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\n\n\n\nas(hic, \"GInteractions\")\n##  GInteractions object with 34063 interactions and 4 metadata columns:\n##            seqnames1       ranges1     seqnames2       ranges2 |   bin_id1\n##                &lt;Rle&gt;     &lt;IRanges&gt;         &lt;Rle&gt;     &lt;IRanges&gt; | &lt;numeric&gt;\n##        [1]        II        1-2000 ---        II        1-2000 |       116\n##        [2]        II        1-2000 ---        II     4001-6000 |       116\n##        [3]        II        1-2000 ---        II     6001-8000 |       116\n##        [4]        II        1-2000 ---        II    8001-10000 |       116\n##        [5]        II        1-2000 ---        II   10001-12000 |       116\n##        ...       ...           ... ...       ...           ... .       ...\n##    [34059]        II 804001-806000 ---        II 810001-812000 |       518\n##    [34060]        II 806001-808000 ---        II 806001-808000 |       519\n##    [34061]        II 806001-808000 ---        II 808001-810000 |       519\n##    [34062]        II 806001-808000 ---        II 810001-812000 |       519\n##    [34063]        II 808001-810000 ---        II 808001-810000 |       520\n##              bin_id2     count  balanced\n##            &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n##        [1]       116         1       NaN\n##        [2]       118         2       NaN\n##        [3]       119         3       NaN\n##        [4]       120        15       NaN\n##        [5]       121         9       NaN\n##        ...       ...       ...       ...\n##    [34059]       521         1       NaN\n##    [34060]       519        15 0.0560633\n##    [34061]       520        25       NaN\n##    [34062]       521         1       NaN\n##    [34063]       520        10       NaN\n##    -------\n##    regions: 407 ranges and 4 metadata columns\n##    seqinfo: 16 sequences from an unspecified genome\n\n\n\nas(hic, \"data.frame\") |&gt; head()\n##    seqnames1 start1 end1 width1 strand1 bin_id1 weight1 center1 seqnames2\n##  1        II      1 2000   2000       *     116     NaN    1000        II\n##  2        II      1 2000   2000       *     116     NaN    1000        II\n##  3        II      1 2000   2000       *     116     NaN    1000        II\n##  4        II      1 2000   2000       *     116     NaN    1000        II\n##  5        II      1 2000   2000       *     116     NaN    1000        II\n##  6        II      1 2000   2000       *     116     NaN    1000        II\n##    start2  end2 width2 strand2 bin_id2    weight2 center2 count balanced\n##  1      1  2000   2000       *     116        NaN    1000     1      NaN\n##  2   4001  6000   2000       *     118        NaN    5000     2      NaN\n##  3   6001  8000   2000       *     119        NaN    7000     3      NaN\n##  4   8001 10000   2000       *     120 0.04611120    9000    15      NaN\n##  5  10001 12000   2000       *     121 0.03348075   11000     9      NaN\n##  6  12001 14000   2000       *     122 0.03389168   13000     6      NaN\n\n\n\nas.matrix(hic)[1:10, 1:10]\n##  10 x 10 sparse Matrix of class \"dgTMatrix\"\n##                                                                            \n##   [1,] NaN . NaN NaN        NaN        NaN        NaN        NaN        NaN\n##   [2,]   . .   .   . .          .          .          .          .         \n##   [3,] NaN .   . NaN        NaN        NaN        NaN        NaN        NaN\n##   [4,] NaN . NaN NaN        NaN        NaN        NaN        NaN        NaN\n##   [5,] NaN . NaN NaN 0.08079721 0.18680431 0.13127403 0.08833001 0.06759757\n##   [6,] NaN . NaN NaN 0.18680431 0.08183011 0.19176749 0.12687633 0.10078115\n##   [7,] NaN . NaN NaN 0.13127403 0.19176749 0.08040523 0.13690173 0.13249106\n##   [8,] NaN . NaN NaN 0.08833001 0.12687633 0.13690173 0.07977117 0.18151495\n##   [9,] NaN . NaN NaN 0.06759757 0.10078115 0.13249106 0.18151495 0.06494950\n##  [10,] NaN . NaN NaN 0.06021225 0.07728955 0.09404388 0.12720548 0.11622354\n##                  \n##   [1,]        NaN\n##   [2,] .         \n##   [3,]        NaN\n##   [4,]        NaN\n##   [5,] 0.06021225\n##   [6,] 0.07728955\n##   [7,] 0.09404388\n##   [8,] 0.12720548\n##   [9,] 0.11622354\n##  [10,] 0.06796588\nas.matrix(hic, sparse = FALSE)[1:10, 1:10]\n##        [,1] [,2] [,3] [,4]       [,5]       [,6]       [,7]       [,8]\n##   [1,]  NaN    0  NaN  NaN        NaN        NaN        NaN        NaN\n##   [2,]    0    0    0    0 0.00000000 0.00000000 0.00000000 0.00000000\n##   [3,]  NaN    0    0  NaN        NaN        NaN        NaN        NaN\n##   [4,]  NaN    0  NaN  NaN        NaN        NaN        NaN        NaN\n##   [5,]  NaN    0  NaN  NaN 0.08079721 0.18680431 0.13127403 0.08833001\n##   [6,]  NaN    0  NaN  NaN 0.18680431 0.08183011 0.19176749 0.12687633\n##   [7,]  NaN    0  NaN  NaN 0.13127403 0.19176749 0.08040523 0.13690173\n##   [8,]  NaN    0  NaN  NaN 0.08833001 0.12687633 0.13690173 0.07977117\n##   [9,]  NaN    0  NaN  NaN 0.06759757 0.10078115 0.13249106 0.18151495\n##  [10,]  NaN    0  NaN  NaN 0.06021225 0.07728955 0.09404388 0.12720548\n##              [,9]      [,10]\n##   [1,]        NaN        NaN\n##   [2,] 0.00000000 0.00000000\n##   [3,]        NaN        NaN\n##   [4,]        NaN        NaN\n##   [5,] 0.06759757 0.06021225\n##   [6,] 0.10078115 0.07728955\n##   [7,] 0.13249106 0.09404388\n##   [8,] 0.18151495 0.12720548\n##   [9,] 0.06494950 0.11622354\n##  [10,] 0.11622354 0.06796588\nas.matrix(hic, use.scores = 'count', sparse = FALSE)[1:10, 1:10]\n##        [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]\n##   [1,]    1    0    2    3   15    9    6    1    2     6\n##   [2,]    0    0    0    0    0    0    0    0    0     0\n##   [3,]    2    0    0   12   14   17    6    6   14    11\n##   [4,]    3    0   12    1   27   20    9    6   11    13\n##   [5,]   15    0   14   27   38  121   84   46   75    56\n##   [6,]    9    0   17   20  121   73  169   91  154    99\n##   [7,]    6    0    6    9   84  169   70   97  200   119\n##   [8,]    1    0    6    6   46   91   97   46  223   131\n##   [9,]    2    0   14   11   75  154  200  223  170   255\n##  [10,]    6    0   11   13   56   99  119  131  255   125\n\n\n\n\nlibrary(HiCool)\ncfs &lt;- list(\n    WT_G2M_rep1 = importHiCoolFolder('results/HiCool', '3KHHUE'), \n    WT_G2M_rep2 = importHiCoolFolder('results/HiCool', 'UVNG7M'), \n    wpl1_G2M_rep1 = importHiCoolFolder('results/HiCool', 'Q4KX6Z'), \n    wpl1_G2M_rep2 = importHiCoolFolder('results/HiCool', '3N0L25')\n)\ncfs\n##  $WT_G2M_rep1\n##  CoolFile object\n##  .mcool file: results/HiCool/matrices/W303_G2M_WT_rep1^mapped-S288c^3KHHUE.mcool \n##  resolution: 1000 \n##  pairs file: results/HiCool/pairs/W303_G2M_WT_rep1^mapped-S288c^3KHHUE.pairs \n##  metadata(3): log args stats\n##  \n##  $WT_G2M_rep2\n##  CoolFile object\n##  .mcool file: results/HiCool/matrices/W303_G2M_WT_rep2^mapped-S288c^UVNG7M.mcool \n##  resolution: 1000 \n##  pairs file: results/HiCool/pairs/W303_G2M_WT_rep2^mapped-S288c^UVNG7M.pairs \n##  metadata(3): log args stats\n##  \n##  $wpl1_G2M_rep1\n##  CoolFile object\n##  .mcool file: results/HiCool/matrices/W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.mcool \n##  resolution: 1000 \n##  pairs file: results/HiCool/pairs/W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.pairs \n##  metadata(3): log args stats\n##  \n##  $wpl1_G2M_rep2\n##  CoolFile object\n##  .mcool file: results/HiCool/matrices/W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.mcool \n##  resolution: 1000 \n##  pairs file: results/HiCool/pairs/W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.pairs \n##  metadata(3): log args stats\nlibrary(purrr)\nlibrary(HiCExperiment)\nhics &lt;- map(cfs, import, resolution = 2000)\nhics\n##  $WT_G2M_rep1\n##  `HiCExperiment` object with 12,998,423 contacts over 6,045 regions \n##  -------\n##  fileName: \"results/HiCool/matrices/W303_G2M_WT_rep1^mapped-S288c^3KHHUE.mcool\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 3653534 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: results/HiCool/pairs/W303_G2M_WT_rep1^mapped-S288c^3KHHUE.pairs \n##  metadata(3): log args stats\n##  \n##  $WT_G2M_rep2\n##  `HiCExperiment` object with 30,178,172 contacts over 6,045 regions \n##  -------\n##  fileName: \"results/HiCool/matrices/W303_G2M_WT_rep2^mapped-S288c^UVNG7M.mcool\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 6540132 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: results/HiCool/pairs/W303_G2M_WT_rep2^mapped-S288c^UVNG7M.pairs \n##  metadata(3): log args stats\n##  \n##  $wpl1_G2M_rep1\n##  `HiCExperiment` object with 23,219,590 contacts over 6,045 regions \n##  -------\n##  fileName: \"results/HiCool/matrices/W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.mcool\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 5278190 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: results/HiCool/pairs/W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.pairs \n##  metadata(3): log args stats\n##  \n##  $wpl1_G2M_rep2\n##  `HiCExperiment` object with 27,438,716 contacts over 6,045 regions \n##  -------\n##  fileName: \"results/HiCool/matrices/W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.mcool\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 6000706 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: results/HiCool/pairs/W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.pairs \n##  metadata(3): log args stats\n\n\n\nlibrary(HiContacts)\nlibrary(multiHiCcompare)\nlibrary(dplyr)\nhics_list &lt;- map(hics, ~ .x['XI'] |&gt; \n    as(\"data.frame\") |&gt;\n    select(start1, start2, count) |&gt; \n    mutate(chr = 11) |&gt;\n    relocate(chr) \n)\nmhicc &lt;- make_hicexp(\n    data_list = hics_list, \n    groups = factor(c(1, 1, 2, 2)\n), A.min = 1)\nmhicc\n##  Hi-C Experiment Object \n##  2 experimental groups \n##  Group 1 has 2 samples \n##  Group 2 has 2 samples\n\n\nmhicc &lt;- cyclic_loess(mhicc, span = 0.2) |&gt; hic_exactTest()\nmhicc\n##  Hi-C Experiment Object \n##  2 experimental groups \n##  Group 1 has 2 samples \n##  Group 2 has 2 samples \n##  Data has been normalized\n\n\ndf &lt;- results(mhicc) |&gt; as_tibble() \ndf |&gt; \n    mutate(group = case_when(\n        region1 &lt; 430000 & region2 &gt; 450000 ~ 'Inter arms',\n        region1 &gt;= 430000 & region2 &lt;= 450000 ~ 'At centro',\n        .default = 'Intra arms'\n    )) |&gt; \n    mutate(sign = p.value &lt;= 0.05 & abs(logFC) &gt;= 1) |&gt;\n    ggplot(aes(x = logFC, y = -log10(p.value), col = sign)) + \n    geom_point(size = 0.2) + \n    theme_bw() + \n    facet_wrap(~group) + \n    ylim(c(0, 6)) + \n    theme(legend.position = 'none') + \n    scale_color_manual(values = c('grey', 'black'))\n##  Warning: Removed 34 rows containing missing values (`geom_point()`).\n\n\n\n\n\n\n\n\ngis &lt;- rename(df, seqnames1 = chr, start1 = region1, start2 = region2) |&gt; \n    mutate(\n        seqnames2 = seqnames1, \n        end1 = start1 + 1999, \n        end2 = start2 + 1999\n    ) |&gt; \n    filter(abs(logFC) &gt;= 1) |&gt;\n    df2gi() \nplotMatrix(gis, use.scores = 'logFC', scale = 'linear', limits = c(-2, 2), cmap = bgrColors())\n\n\n\n\n\n\n\n\nRead the following sections from the OHCA book:\n\nHiCExperiment coercion\nInteroperability of HiCExperiment with other R packages\n\n\n##  ─ Session info ────────────────────────────────────────────────────────────\n##   setting  value\n##   version  R version 4.3.0 (2023-04-21)\n##   os       Ubuntu 18.04.6 LTS\n##   system   x86_64, linux-gnu\n##   ui       X11\n##   language (EN)\n##   collate  en_US.UTF-8\n##   ctype    en_US.UTF-8\n##   tz       Europe/Paris\n##   date     2023-07-28\n##   pandoc   2.13 @ /usr/bin/ (via rmarkdown)\n##  \n##  ─ Packages ────────────────────────────────────────────────────────────────\n##   package                * version   date (UTC) lib source\n##   abind                    1.4-5     2016-07-21 [1] CRAN (R 4.3.0)\n##   aggregation              1.0.1     2018-01-25 [1] CRAN (R 4.3.0)\n##   AnnotationDbi            1.62.2    2023-07-02 [1] Bioconductor\n##   AnnotationHub          * 3.8.0     2023-04-25 [1] Bioconductor\n##   basilisk                 1.12.1    2023-06-30 [1] Bioconductor\n##   basilisk.utils           1.12.1    2023-05-19 [1] Bioconductor\n##   beeswarm                 0.4.0     2021-06-01 [1] CRAN (R 4.3.0)\n##   Biobase                  2.60.0    2023-04-25 [1] Bioconductor\n##   BiocFileCache          * 2.8.0     2023-04-25 [1] Bioconductor\n##   BiocGenerics           * 0.46.0    2023-04-25 [1] Bioconductor\n##   BiocIO                   1.10.0    2023-04-25 [1] Bioconductor\n##   BiocManager              1.30.21.1 2023-07-18 [1] CRAN (R 4.3.0)\n##   BiocParallel             1.34.2    2023-05-22 [1] Bioconductor\n##   BiocVersion              3.17.1    2022-11-04 [1] Bioconductor\n##   Biostrings               2.68.1    2023-05-16 [1] Bioconductor\n##   bit                      4.0.5     2022-11-15 [1] CRAN (R 4.3.0)\n##   bit64                    4.0.5     2020-08-30 [1] CRAN (R 4.3.0)\n##   bitops                   1.0-7     2021-04-24 [1] CRAN (R 4.3.0)\n##   blob                     1.2.4     2023-03-17 [1] CRAN (R 4.3.0)\n##   bookdown                 0.34      2023-05-09 [1] CRAN (R 4.3.0)\n##   cachem                   1.0.8     2023-05-01 [1] CRAN (R 4.3.0)\n##   Cairo                    1.6-0     2022-07-05 [1] CRAN (R 4.3.0)\n##   calibrate                1.7.7     2020-06-19 [1] CRAN (R 4.3.0)\n##   cli                      3.6.1     2023-03-23 [1] CRAN (R 4.3.0)\n##   codetools                0.2-19    2023-02-01 [1] CRAN (R 4.3.0)\n##   colorspace               2.1-0     2023-01-23 [1] CRAN (R 4.3.0)\n##   cowplot                  1.1.1     2020-12-30 [1] CRAN (R 4.3.0)\n##   crayon                   1.5.2     2022-09-29 [1] CRAN (R 4.3.0)\n##   curl                     5.0.1     2023-06-07 [1] CRAN (R 4.3.0)\n##   data.table               1.14.8    2023-02-17 [1] CRAN (R 4.3.0)\n##   DBI                      1.1.3     2022-06-18 [1] CRAN (R 4.3.0)\n##   dbplyr                 * 2.3.3     2023-07-07 [1] CRAN (R 4.3.0)\n##   DelayedArray             0.26.6    2023-07-02 [1] Bioconductor\n##   digest                   0.6.33    2023-07-07 [1] CRAN (R 4.3.0)\n##   dir.expiry               1.8.0     2023-04-25 [1] Bioconductor\n##   dplyr                  * 1.1.2     2023-04-20 [1] CRAN (R 4.3.0)\n##   edgeR                    3.42.4    2023-05-31 [1] Bioconductor\n##   ellipsis                 0.3.2     2021-04-29 [1] CRAN (R 4.3.0)\n##   evaluate                 0.21      2023-05-05 [1] CRAN (R 4.3.0)\n##   ExperimentHub          * 2.8.1     2023-07-12 [1] Bioconductor\n##   fansi                    1.0.4     2023-01-22 [1] CRAN (R 4.3.0)\n##   farver                   2.1.1     2022-07-06 [1] CRAN (R 4.3.0)\n##   fastmap                  1.1.1     2023-02-24 [1] CRAN (R 4.3.0)\n##   filelock                 1.0.2     2018-10-05 [1] CRAN (R 4.3.0)\n##   generics                 0.1.3     2022-07-05 [1] CRAN (R 4.3.0)\n##   GenomeInfoDb             1.36.1    2023-06-21 [1] Bioconductor\n##   GenomeInfoDbData         1.2.10    2023-04-02 [1] Bioconductor\n##   GenomicRanges            1.52.0    2023-04-25 [1] Bioconductor\n##   ggbeeswarm               0.7.2     2023-04-29 [1] CRAN (R 4.3.0)\n##   ggplot2                * 3.4.2     2023-04-03 [1] CRAN (R 4.3.0)\n##   ggrastr                  1.0.2     2023-06-01 [1] CRAN (R 4.3.0)\n##   glue                     1.6.2     2022-02-24 [1] CRAN (R 4.3.0)\n##   gridExtra                2.3       2017-09-09 [1] CRAN (R 4.3.0)\n##   gtable                   0.3.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   gtools                   3.9.4     2022-11-27 [1] CRAN (R 4.3.0)\n##   HiCcompare               1.22.1    2023-06-04 [1] Bioconductor\n##   HiCExperiment          * 1.1.1     2023-07-27 [1] Github (js2264/HiCExperiment@9e8f7bb)\n##   HiContacts             * 1.3.1     2023-07-27 [1] Github (js2264/HiContacts@d3bdfef)\n##   HiContactsData         * 1.3.0     2023-05-26 [1] Github (js2264/HiContactsData@adcb51f)\n##   HiCool                 * 1.1.0     2023-07-27 [1] local (/home/rsg/repos/HiCool)\n##   hms                      1.1.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   htmltools                0.5.5     2023-03-23 [1] CRAN (R 4.3.0)\n##   htmlwidgets              1.6.2     2023-03-17 [1] CRAN (R 4.3.0)\n##   httpuv                   1.6.11    2023-05-11 [1] CRAN (R 4.3.0)\n##   httr                     1.4.6     2023-05-08 [1] CRAN (R 4.3.0)\n##   InteractionSet           1.29.1    2023-06-13 [1] Github (LTLA/InteractionSet@62cd50a)\n##   interactiveDisplayBase   1.38.0    2023-04-25 [1] Bioconductor\n##   IRanges                  2.34.1    2023-06-22 [1] Bioconductor\n##   jsonlite                 1.8.7     2023-06-29 [1] CRAN (R 4.3.0)\n##   KEGGREST                 1.40.0    2023-04-25 [1] Bioconductor\n##   KernSmooth               2.23-22   2023-07-10 [1] CRAN (R 4.3.0)\n##   knitr                    1.43      2023-05-25 [1] CRAN (R 4.3.0)\n##   labeling                 0.4.2     2020-10-20 [1] CRAN (R 4.3.0)\n##   later                    1.3.1     2023-05-02 [1] CRAN (R 4.3.0)\n##   lattice                  0.21-8    2023-04-05 [1] CRAN (R 4.3.0)\n##   lazyeval                 0.2.2     2019-03-15 [1] CRAN (R 4.3.0)\n##   lifecycle                1.0.3     2022-10-07 [1] CRAN (R 4.3.0)\n##   limma                    3.56.2    2023-06-04 [1] Bioconductor\n##   locfit                   1.5-9.8   2023-06-11 [1] CRAN (R 4.3.0)\n##   magrittr                 2.0.3     2022-03-30 [1] CRAN (R 4.3.0)\n##   MASS                     7.3-60    2023-05-04 [1] CRAN (R 4.3.0)\n##   Matrix                   1.6-0     2023-07-08 [1] CRAN (R 4.3.0)\n##   MatrixGenerics           1.12.2    2023-06-09 [1] Bioconductor\n##   matrixStats              1.0.0     2023-06-02 [1] CRAN (R 4.3.0)\n##   memoise                  2.0.1     2021-11-26 [1] CRAN (R 4.3.0)\n##   mgcv                     1.9-0     2023-07-11 [1] CRAN (R 4.3.0)\n##   mime                     0.12      2021-09-28 [1] CRAN (R 4.3.0)\n##   multiHiCcompare        * 1.18.1    2023-07-02 [1] Bioconductor\n##   munsell                  0.5.0     2018-06-12 [1] CRAN (R 4.3.0)\n##   nlme                     3.1-162   2023-01-31 [1] CRAN (R 4.3.0)\n##   pbapply                  1.7-2     2023-06-27 [1] CRAN (R 4.3.0)\n##   pheatmap                 1.0.12    2019-01-04 [1] CRAN (R 4.3.0)\n##   pillar                   1.9.0     2023-03-22 [1] CRAN (R 4.3.0)\n##   pkgconfig                2.0.3     2019-09-22 [1] CRAN (R 4.3.0)\n##   plotly                   4.10.2    2023-06-03 [1] CRAN (R 4.3.0)\n##   png                      0.1-8     2022-11-29 [1] CRAN (R 4.3.0)\n##   promises                 1.2.0.1   2021-02-11 [1] CRAN (R 4.3.0)\n##   purrr                  * 1.0.1     2023-01-10 [1] CRAN (R 4.3.0)\n##   qqman                    0.1.8     2021-04-19 [1] CRAN (R 4.3.0)\n##   R6                       2.5.1     2021-08-19 [1] CRAN (R 4.3.0)\n##   rappdirs                 0.3.3     2021-01-31 [1] CRAN (R 4.3.0)\n##   RColorBrewer             1.1-3     2022-04-03 [1] CRAN (R 4.3.0)\n##   Rcpp                     1.0.11    2023-07-06 [1] CRAN (R 4.3.0)\n##   RCurl                    1.98-1.12 2023-03-27 [1] CRAN (R 4.3.0)\n##   readr                    2.1.4     2023-02-10 [1] CRAN (R 4.3.0)\n##   reticulate               1.30      2023-06-09 [1] CRAN (R 4.3.0)\n##   rhdf5                    2.44.0    2023-04-25 [1] Bioconductor\n##   rhdf5filters             1.12.1    2023-04-30 [1] Bioconductor\n##   Rhdf5lib                 1.22.0    2023-04-25 [1] Bioconductor\n##   rlang                    1.1.1     2023-04-28 [1] CRAN (R 4.3.0)\n##   rmarkdown                2.23      2023-07-01 [1] CRAN (R 4.3.0)\n##   rmdformats               1.0.4     2022-05-17 [1] CRAN (R 4.3.0)\n##   RSpectra                 0.16-1    2022-04-24 [1] CRAN (R 4.3.0)\n##   RSQLite                  2.3.1     2023-04-03 [1] CRAN (R 4.3.0)\n##   rstudioapi               0.15.0    2023-07-07 [1] CRAN (R 4.3.0)\n##   S4Arrays                 1.0.5     2023-07-24 [1] Bioconductor\n##   S4Vectors                0.38.1    2023-05-02 [1] Bioconductor\n##   scales                   1.2.1     2022-08-20 [1] CRAN (R 4.3.0)\n##   sessioninfo              1.2.2     2021-12-06 [1] CRAN (R 4.3.0)\n##   shiny                    1.7.4.1   2023-07-06 [1] CRAN (R 4.3.0)\n##   strawr                   0.0.91    2023-03-29 [1] CRAN (R 4.3.0)\n##   stringi                  1.7.12    2023-01-11 [1] CRAN (R 4.3.0)\n##   stringr                  1.5.0     2022-12-02 [1] CRAN (R 4.3.0)\n##   SummarizedExperiment     1.30.2    2023-06-06 [1] Bioconductor\n##   tibble                   3.2.1     2023-03-20 [1] CRAN (R 4.3.0)\n##   tidyr                    1.3.0     2023-01-24 [1] CRAN (R 4.3.0)\n##   tidyselect               1.2.0     2022-10-10 [1] CRAN (R 4.3.0)\n##   tzdb                     0.4.0     2023-05-12 [1] CRAN (R 4.3.0)\n##   utf8                     1.2.3     2023-01-31 [1] CRAN (R 4.3.0)\n##   vctrs                    0.6.3     2023-06-14 [1] CRAN (R 4.3.0)\n##   vipor                    0.4.5     2017-03-22 [1] CRAN (R 4.3.0)\n##   viridisLite              0.4.2     2023-05-02 [1] CRAN (R 4.3.0)\n##   vroom                    1.6.3     2023-04-28 [1] CRAN (R 4.3.0)\n##   withr                    2.5.0     2022-03-03 [1] CRAN (R 4.3.0)\n##   xfun                     0.39      2023-04-20 [1] CRAN (R 4.3.0)\n##   xtable                   1.8-4     2019-04-21 [1] CRAN (R 4.3.0)\n##   XVector                  0.40.0    2023-04-25 [1] Bioconductor\n##   yaml                     2.3.7     2023-01-23 [1] CRAN (R 4.3.0)\n##   zlibbioc                 1.46.0    2023-04-25 [1] Bioconductor\n##  \n##   [1] /home/rsg/R/x86_64-pc-linux-gnu-library/4.3\n##   [2] /usr/local/lib/R-4.3/lib/R/library\n##  \n##  ───────────────────────────────────────────────────────────────────────────"
  },
  {
    "objectID": "interoperability.html#coercing-hicexperiment-objects",
    "href": "interoperability.html#coercing-hicexperiment-objects",
    "title": "Interoperability of HiCExperiment",
    "section": "",
    "text": "hic &lt;- import(\n    CoolFile(HiContactsData('yeast_wt', 'mcool')), \n    focus = 'II', \n    resolution = 2000\n)\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\n\n\n\nas(hic, \"GInteractions\")\n##  GInteractions object with 34063 interactions and 4 metadata columns:\n##            seqnames1       ranges1     seqnames2       ranges2 |   bin_id1\n##                &lt;Rle&gt;     &lt;IRanges&gt;         &lt;Rle&gt;     &lt;IRanges&gt; | &lt;numeric&gt;\n##        [1]        II        1-2000 ---        II        1-2000 |       116\n##        [2]        II        1-2000 ---        II     4001-6000 |       116\n##        [3]        II        1-2000 ---        II     6001-8000 |       116\n##        [4]        II        1-2000 ---        II    8001-10000 |       116\n##        [5]        II        1-2000 ---        II   10001-12000 |       116\n##        ...       ...           ... ...       ...           ... .       ...\n##    [34059]        II 804001-806000 ---        II 810001-812000 |       518\n##    [34060]        II 806001-808000 ---        II 806001-808000 |       519\n##    [34061]        II 806001-808000 ---        II 808001-810000 |       519\n##    [34062]        II 806001-808000 ---        II 810001-812000 |       519\n##    [34063]        II 808001-810000 ---        II 808001-810000 |       520\n##              bin_id2     count  balanced\n##            &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n##        [1]       116         1       NaN\n##        [2]       118         2       NaN\n##        [3]       119         3       NaN\n##        [4]       120        15       NaN\n##        [5]       121         9       NaN\n##        ...       ...       ...       ...\n##    [34059]       521         1       NaN\n##    [34060]       519        15 0.0560633\n##    [34061]       520        25       NaN\n##    [34062]       521         1       NaN\n##    [34063]       520        10       NaN\n##    -------\n##    regions: 407 ranges and 4 metadata columns\n##    seqinfo: 16 sequences from an unspecified genome\n\n\n\nas(hic, \"data.frame\") |&gt; head()\n##    seqnames1 start1 end1 width1 strand1 bin_id1 weight1 center1 seqnames2\n##  1        II      1 2000   2000       *     116     NaN    1000        II\n##  2        II      1 2000   2000       *     116     NaN    1000        II\n##  3        II      1 2000   2000       *     116     NaN    1000        II\n##  4        II      1 2000   2000       *     116     NaN    1000        II\n##  5        II      1 2000   2000       *     116     NaN    1000        II\n##  6        II      1 2000   2000       *     116     NaN    1000        II\n##    start2  end2 width2 strand2 bin_id2    weight2 center2 count balanced\n##  1      1  2000   2000       *     116        NaN    1000     1      NaN\n##  2   4001  6000   2000       *     118        NaN    5000     2      NaN\n##  3   6001  8000   2000       *     119        NaN    7000     3      NaN\n##  4   8001 10000   2000       *     120 0.04611120    9000    15      NaN\n##  5  10001 12000   2000       *     121 0.03348075   11000     9      NaN\n##  6  12001 14000   2000       *     122 0.03389168   13000     6      NaN\n\n\n\nas.matrix(hic)[1:10, 1:10]\n##  10 x 10 sparse Matrix of class \"dgTMatrix\"\n##                                                                            \n##   [1,] NaN . NaN NaN        NaN        NaN        NaN        NaN        NaN\n##   [2,]   . .   .   . .          .          .          .          .         \n##   [3,] NaN .   . NaN        NaN        NaN        NaN        NaN        NaN\n##   [4,] NaN . NaN NaN        NaN        NaN        NaN        NaN        NaN\n##   [5,] NaN . NaN NaN 0.08079721 0.18680431 0.13127403 0.08833001 0.06759757\n##   [6,] NaN . NaN NaN 0.18680431 0.08183011 0.19176749 0.12687633 0.10078115\n##   [7,] NaN . NaN NaN 0.13127403 0.19176749 0.08040523 0.13690173 0.13249106\n##   [8,] NaN . NaN NaN 0.08833001 0.12687633 0.13690173 0.07977117 0.18151495\n##   [9,] NaN . NaN NaN 0.06759757 0.10078115 0.13249106 0.18151495 0.06494950\n##  [10,] NaN . NaN NaN 0.06021225 0.07728955 0.09404388 0.12720548 0.11622354\n##                  \n##   [1,]        NaN\n##   [2,] .         \n##   [3,]        NaN\n##   [4,]        NaN\n##   [5,] 0.06021225\n##   [6,] 0.07728955\n##   [7,] 0.09404388\n##   [8,] 0.12720548\n##   [9,] 0.11622354\n##  [10,] 0.06796588\nas.matrix(hic, sparse = FALSE)[1:10, 1:10]\n##        [,1] [,2] [,3] [,4]       [,5]       [,6]       [,7]       [,8]\n##   [1,]  NaN    0  NaN  NaN        NaN        NaN        NaN        NaN\n##   [2,]    0    0    0    0 0.00000000 0.00000000 0.00000000 0.00000000\n##   [3,]  NaN    0    0  NaN        NaN        NaN        NaN        NaN\n##   [4,]  NaN    0  NaN  NaN        NaN        NaN        NaN        NaN\n##   [5,]  NaN    0  NaN  NaN 0.08079721 0.18680431 0.13127403 0.08833001\n##   [6,]  NaN    0  NaN  NaN 0.18680431 0.08183011 0.19176749 0.12687633\n##   [7,]  NaN    0  NaN  NaN 0.13127403 0.19176749 0.08040523 0.13690173\n##   [8,]  NaN    0  NaN  NaN 0.08833001 0.12687633 0.13690173 0.07977117\n##   [9,]  NaN    0  NaN  NaN 0.06759757 0.10078115 0.13249106 0.18151495\n##  [10,]  NaN    0  NaN  NaN 0.06021225 0.07728955 0.09404388 0.12720548\n##              [,9]      [,10]\n##   [1,]        NaN        NaN\n##   [2,] 0.00000000 0.00000000\n##   [3,]        NaN        NaN\n##   [4,]        NaN        NaN\n##   [5,] 0.06759757 0.06021225\n##   [6,] 0.10078115 0.07728955\n##   [7,] 0.13249106 0.09404388\n##   [8,] 0.18151495 0.12720548\n##   [9,] 0.06494950 0.11622354\n##  [10,] 0.11622354 0.06796588\nas.matrix(hic, use.scores = 'count', sparse = FALSE)[1:10, 1:10]\n##        [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]\n##   [1,]    1    0    2    3   15    9    6    1    2     6\n##   [2,]    0    0    0    0    0    0    0    0    0     0\n##   [3,]    2    0    0   12   14   17    6    6   14    11\n##   [4,]    3    0   12    1   27   20    9    6   11    13\n##   [5,]   15    0   14   27   38  121   84   46   75    56\n##   [6,]    9    0   17   20  121   73  169   91  154    99\n##   [7,]    6    0    6    9   84  169   70   97  200   119\n##   [8,]    1    0    6    6   46   91   97   46  223   131\n##   [9,]    2    0   14   11   75  154  200  223  170   255\n##  [10,]    6    0   11   13   56   99  119  131  255   125"
  },
  {
    "objectID": "interoperability.html#using-hicexperiment-in-other-packages",
    "href": "interoperability.html#using-hicexperiment-in-other-packages",
    "title": "Interoperability of HiCExperiment",
    "section": "",
    "text": "library(HiCool)\ncfs &lt;- list(\n    WT_G2M_rep1 = importHiCoolFolder('results/HiCool', '3KHHUE'), \n    WT_G2M_rep2 = importHiCoolFolder('results/HiCool', 'UVNG7M'), \n    wpl1_G2M_rep1 = importHiCoolFolder('results/HiCool', 'Q4KX6Z'), \n    wpl1_G2M_rep2 = importHiCoolFolder('results/HiCool', '3N0L25')\n)\ncfs\n##  $WT_G2M_rep1\n##  CoolFile object\n##  .mcool file: results/HiCool/matrices/W303_G2M_WT_rep1^mapped-S288c^3KHHUE.mcool \n##  resolution: 1000 \n##  pairs file: results/HiCool/pairs/W303_G2M_WT_rep1^mapped-S288c^3KHHUE.pairs \n##  metadata(3): log args stats\n##  \n##  $WT_G2M_rep2\n##  CoolFile object\n##  .mcool file: results/HiCool/matrices/W303_G2M_WT_rep2^mapped-S288c^UVNG7M.mcool \n##  resolution: 1000 \n##  pairs file: results/HiCool/pairs/W303_G2M_WT_rep2^mapped-S288c^UVNG7M.pairs \n##  metadata(3): log args stats\n##  \n##  $wpl1_G2M_rep1\n##  CoolFile object\n##  .mcool file: results/HiCool/matrices/W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.mcool \n##  resolution: 1000 \n##  pairs file: results/HiCool/pairs/W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.pairs \n##  metadata(3): log args stats\n##  \n##  $wpl1_G2M_rep2\n##  CoolFile object\n##  .mcool file: results/HiCool/matrices/W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.mcool \n##  resolution: 1000 \n##  pairs file: results/HiCool/pairs/W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.pairs \n##  metadata(3): log args stats\nlibrary(purrr)\nlibrary(HiCExperiment)\nhics &lt;- map(cfs, import, resolution = 2000)\nhics\n##  $WT_G2M_rep1\n##  `HiCExperiment` object with 12,998,423 contacts over 6,045 regions \n##  -------\n##  fileName: \"results/HiCool/matrices/W303_G2M_WT_rep1^mapped-S288c^3KHHUE.mcool\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 3653534 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: results/HiCool/pairs/W303_G2M_WT_rep1^mapped-S288c^3KHHUE.pairs \n##  metadata(3): log args stats\n##  \n##  $WT_G2M_rep2\n##  `HiCExperiment` object with 30,178,172 contacts over 6,045 regions \n##  -------\n##  fileName: \"results/HiCool/matrices/W303_G2M_WT_rep2^mapped-S288c^UVNG7M.mcool\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 6540132 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: results/HiCool/pairs/W303_G2M_WT_rep2^mapped-S288c^UVNG7M.pairs \n##  metadata(3): log args stats\n##  \n##  $wpl1_G2M_rep1\n##  `HiCExperiment` object with 23,219,590 contacts over 6,045 regions \n##  -------\n##  fileName: \"results/HiCool/matrices/W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.mcool\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 5278190 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: results/HiCool/pairs/W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.pairs \n##  metadata(3): log args stats\n##  \n##  $wpl1_G2M_rep2\n##  `HiCExperiment` object with 27,438,716 contacts over 6,045 regions \n##  -------\n##  fileName: \"results/HiCool/matrices/W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.mcool\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 6000706 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: results/HiCool/pairs/W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.pairs \n##  metadata(3): log args stats\n\n\n\nlibrary(HiContacts)\nlibrary(multiHiCcompare)\nlibrary(dplyr)\nhics_list &lt;- map(hics, ~ .x['XI'] |&gt; \n    as(\"data.frame\") |&gt;\n    select(start1, start2, count) |&gt; \n    mutate(chr = 11) |&gt;\n    relocate(chr) \n)\nmhicc &lt;- make_hicexp(\n    data_list = hics_list, \n    groups = factor(c(1, 1, 2, 2)\n), A.min = 1)\nmhicc\n##  Hi-C Experiment Object \n##  2 experimental groups \n##  Group 1 has 2 samples \n##  Group 2 has 2 samples\n\n\nmhicc &lt;- cyclic_loess(mhicc, span = 0.2) |&gt; hic_exactTest()\nmhicc\n##  Hi-C Experiment Object \n##  2 experimental groups \n##  Group 1 has 2 samples \n##  Group 2 has 2 samples \n##  Data has been normalized\n\n\ndf &lt;- results(mhicc) |&gt; as_tibble() \ndf |&gt; \n    mutate(group = case_when(\n        region1 &lt; 430000 & region2 &gt; 450000 ~ 'Inter arms',\n        region1 &gt;= 430000 & region2 &lt;= 450000 ~ 'At centro',\n        .default = 'Intra arms'\n    )) |&gt; \n    mutate(sign = p.value &lt;= 0.05 & abs(logFC) &gt;= 1) |&gt;\n    ggplot(aes(x = logFC, y = -log10(p.value), col = sign)) + \n    geom_point(size = 0.2) + \n    theme_bw() + \n    facet_wrap(~group) + \n    ylim(c(0, 6)) + \n    theme(legend.position = 'none') + \n    scale_color_manual(values = c('grey', 'black'))\n##  Warning: Removed 34 rows containing missing values (`geom_point()`).\n\n\n\n\n\n\n\n\ngis &lt;- rename(df, seqnames1 = chr, start1 = region1, start2 = region2) |&gt; \n    mutate(\n        seqnames2 = seqnames1, \n        end1 = start1 + 1999, \n        end2 = start2 + 1999\n    ) |&gt; \n    filter(abs(logFC) &gt;= 1) |&gt;\n    df2gi() \nplotMatrix(gis, use.scores = 'logFC', scale = 'linear', limits = c(-2, 2), cmap = bgrColors())"
  },
  {
    "objectID": "interoperability.html#read-more",
    "href": "interoperability.html#read-more",
    "title": "Interoperability of HiCExperiment",
    "section": "",
    "text": "Read the following sections from the OHCA book:\n\nHiCExperiment coercion\nInteroperability of HiCExperiment with other R packages"
  },
  {
    "objectID": "interoperability.html#session-info",
    "href": "interoperability.html#session-info",
    "title": "Interoperability of HiCExperiment",
    "section": "",
    "text": "##  ─ Session info ────────────────────────────────────────────────────────────\n##   setting  value\n##   version  R version 4.3.0 (2023-04-21)\n##   os       Ubuntu 18.04.6 LTS\n##   system   x86_64, linux-gnu\n##   ui       X11\n##   language (EN)\n##   collate  en_US.UTF-8\n##   ctype    en_US.UTF-8\n##   tz       Europe/Paris\n##   date     2023-07-28\n##   pandoc   2.13 @ /usr/bin/ (via rmarkdown)\n##  \n##  ─ Packages ────────────────────────────────────────────────────────────────\n##   package                * version   date (UTC) lib source\n##   abind                    1.4-5     2016-07-21 [1] CRAN (R 4.3.0)\n##   aggregation              1.0.1     2018-01-25 [1] CRAN (R 4.3.0)\n##   AnnotationDbi            1.62.2    2023-07-02 [1] Bioconductor\n##   AnnotationHub          * 3.8.0     2023-04-25 [1] Bioconductor\n##   basilisk                 1.12.1    2023-06-30 [1] Bioconductor\n##   basilisk.utils           1.12.1    2023-05-19 [1] Bioconductor\n##   beeswarm                 0.4.0     2021-06-01 [1] CRAN (R 4.3.0)\n##   Biobase                  2.60.0    2023-04-25 [1] Bioconductor\n##   BiocFileCache          * 2.8.0     2023-04-25 [1] Bioconductor\n##   BiocGenerics           * 0.46.0    2023-04-25 [1] Bioconductor\n##   BiocIO                   1.10.0    2023-04-25 [1] Bioconductor\n##   BiocManager              1.30.21.1 2023-07-18 [1] CRAN (R 4.3.0)\n##   BiocParallel             1.34.2    2023-05-22 [1] Bioconductor\n##   BiocVersion              3.17.1    2022-11-04 [1] Bioconductor\n##   Biostrings               2.68.1    2023-05-16 [1] Bioconductor\n##   bit                      4.0.5     2022-11-15 [1] CRAN (R 4.3.0)\n##   bit64                    4.0.5     2020-08-30 [1] CRAN (R 4.3.0)\n##   bitops                   1.0-7     2021-04-24 [1] CRAN (R 4.3.0)\n##   blob                     1.2.4     2023-03-17 [1] CRAN (R 4.3.0)\n##   bookdown                 0.34      2023-05-09 [1] CRAN (R 4.3.0)\n##   cachem                   1.0.8     2023-05-01 [1] CRAN (R 4.3.0)\n##   Cairo                    1.6-0     2022-07-05 [1] CRAN (R 4.3.0)\n##   calibrate                1.7.7     2020-06-19 [1] CRAN (R 4.3.0)\n##   cli                      3.6.1     2023-03-23 [1] CRAN (R 4.3.0)\n##   codetools                0.2-19    2023-02-01 [1] CRAN (R 4.3.0)\n##   colorspace               2.1-0     2023-01-23 [1] CRAN (R 4.3.0)\n##   cowplot                  1.1.1     2020-12-30 [1] CRAN (R 4.3.0)\n##   crayon                   1.5.2     2022-09-29 [1] CRAN (R 4.3.0)\n##   curl                     5.0.1     2023-06-07 [1] CRAN (R 4.3.0)\n##   data.table               1.14.8    2023-02-17 [1] CRAN (R 4.3.0)\n##   DBI                      1.1.3     2022-06-18 [1] CRAN (R 4.3.0)\n##   dbplyr                 * 2.3.3     2023-07-07 [1] CRAN (R 4.3.0)\n##   DelayedArray             0.26.6    2023-07-02 [1] Bioconductor\n##   digest                   0.6.33    2023-07-07 [1] CRAN (R 4.3.0)\n##   dir.expiry               1.8.0     2023-04-25 [1] Bioconductor\n##   dplyr                  * 1.1.2     2023-04-20 [1] CRAN (R 4.3.0)\n##   edgeR                    3.42.4    2023-05-31 [1] Bioconductor\n##   ellipsis                 0.3.2     2021-04-29 [1] CRAN (R 4.3.0)\n##   evaluate                 0.21      2023-05-05 [1] CRAN (R 4.3.0)\n##   ExperimentHub          * 2.8.1     2023-07-12 [1] Bioconductor\n##   fansi                    1.0.4     2023-01-22 [1] CRAN (R 4.3.0)\n##   farver                   2.1.1     2022-07-06 [1] CRAN (R 4.3.0)\n##   fastmap                  1.1.1     2023-02-24 [1] CRAN (R 4.3.0)\n##   filelock                 1.0.2     2018-10-05 [1] CRAN (R 4.3.0)\n##   generics                 0.1.3     2022-07-05 [1] CRAN (R 4.3.0)\n##   GenomeInfoDb             1.36.1    2023-06-21 [1] Bioconductor\n##   GenomeInfoDbData         1.2.10    2023-04-02 [1] Bioconductor\n##   GenomicRanges            1.52.0    2023-04-25 [1] Bioconductor\n##   ggbeeswarm               0.7.2     2023-04-29 [1] CRAN (R 4.3.0)\n##   ggplot2                * 3.4.2     2023-04-03 [1] CRAN (R 4.3.0)\n##   ggrastr                  1.0.2     2023-06-01 [1] CRAN (R 4.3.0)\n##   glue                     1.6.2     2022-02-24 [1] CRAN (R 4.3.0)\n##   gridExtra                2.3       2017-09-09 [1] CRAN (R 4.3.0)\n##   gtable                   0.3.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   gtools                   3.9.4     2022-11-27 [1] CRAN (R 4.3.0)\n##   HiCcompare               1.22.1    2023-06-04 [1] Bioconductor\n##   HiCExperiment          * 1.1.1     2023-07-27 [1] Github (js2264/HiCExperiment@9e8f7bb)\n##   HiContacts             * 1.3.1     2023-07-27 [1] Github (js2264/HiContacts@d3bdfef)\n##   HiContactsData         * 1.3.0     2023-05-26 [1] Github (js2264/HiContactsData@adcb51f)\n##   HiCool                 * 1.1.0     2023-07-27 [1] local (/home/rsg/repos/HiCool)\n##   hms                      1.1.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   htmltools                0.5.5     2023-03-23 [1] CRAN (R 4.3.0)\n##   htmlwidgets              1.6.2     2023-03-17 [1] CRAN (R 4.3.0)\n##   httpuv                   1.6.11    2023-05-11 [1] CRAN (R 4.3.0)\n##   httr                     1.4.6     2023-05-08 [1] CRAN (R 4.3.0)\n##   InteractionSet           1.29.1    2023-06-13 [1] Github (LTLA/InteractionSet@62cd50a)\n##   interactiveDisplayBase   1.38.0    2023-04-25 [1] Bioconductor\n##   IRanges                  2.34.1    2023-06-22 [1] Bioconductor\n##   jsonlite                 1.8.7     2023-06-29 [1] CRAN (R 4.3.0)\n##   KEGGREST                 1.40.0    2023-04-25 [1] Bioconductor\n##   KernSmooth               2.23-22   2023-07-10 [1] CRAN (R 4.3.0)\n##   knitr                    1.43      2023-05-25 [1] CRAN (R 4.3.0)\n##   labeling                 0.4.2     2020-10-20 [1] CRAN (R 4.3.0)\n##   later                    1.3.1     2023-05-02 [1] CRAN (R 4.3.0)\n##   lattice                  0.21-8    2023-04-05 [1] CRAN (R 4.3.0)\n##   lazyeval                 0.2.2     2019-03-15 [1] CRAN (R 4.3.0)\n##   lifecycle                1.0.3     2022-10-07 [1] CRAN (R 4.3.0)\n##   limma                    3.56.2    2023-06-04 [1] Bioconductor\n##   locfit                   1.5-9.8   2023-06-11 [1] CRAN (R 4.3.0)\n##   magrittr                 2.0.3     2022-03-30 [1] CRAN (R 4.3.0)\n##   MASS                     7.3-60    2023-05-04 [1] CRAN (R 4.3.0)\n##   Matrix                   1.6-0     2023-07-08 [1] CRAN (R 4.3.0)\n##   MatrixGenerics           1.12.2    2023-06-09 [1] Bioconductor\n##   matrixStats              1.0.0     2023-06-02 [1] CRAN (R 4.3.0)\n##   memoise                  2.0.1     2021-11-26 [1] CRAN (R 4.3.0)\n##   mgcv                     1.9-0     2023-07-11 [1] CRAN (R 4.3.0)\n##   mime                     0.12      2021-09-28 [1] CRAN (R 4.3.0)\n##   multiHiCcompare        * 1.18.1    2023-07-02 [1] Bioconductor\n##   munsell                  0.5.0     2018-06-12 [1] CRAN (R 4.3.0)\n##   nlme                     3.1-162   2023-01-31 [1] CRAN (R 4.3.0)\n##   pbapply                  1.7-2     2023-06-27 [1] CRAN (R 4.3.0)\n##   pheatmap                 1.0.12    2019-01-04 [1] CRAN (R 4.3.0)\n##   pillar                   1.9.0     2023-03-22 [1] CRAN (R 4.3.0)\n##   pkgconfig                2.0.3     2019-09-22 [1] CRAN (R 4.3.0)\n##   plotly                   4.10.2    2023-06-03 [1] CRAN (R 4.3.0)\n##   png                      0.1-8     2022-11-29 [1] CRAN (R 4.3.0)\n##   promises                 1.2.0.1   2021-02-11 [1] CRAN (R 4.3.0)\n##   purrr                  * 1.0.1     2023-01-10 [1] CRAN (R 4.3.0)\n##   qqman                    0.1.8     2021-04-19 [1] CRAN (R 4.3.0)\n##   R6                       2.5.1     2021-08-19 [1] CRAN (R 4.3.0)\n##   rappdirs                 0.3.3     2021-01-31 [1] CRAN (R 4.3.0)\n##   RColorBrewer             1.1-3     2022-04-03 [1] CRAN (R 4.3.0)\n##   Rcpp                     1.0.11    2023-07-06 [1] CRAN (R 4.3.0)\n##   RCurl                    1.98-1.12 2023-03-27 [1] CRAN (R 4.3.0)\n##   readr                    2.1.4     2023-02-10 [1] CRAN (R 4.3.0)\n##   reticulate               1.30      2023-06-09 [1] CRAN (R 4.3.0)\n##   rhdf5                    2.44.0    2023-04-25 [1] Bioconductor\n##   rhdf5filters             1.12.1    2023-04-30 [1] Bioconductor\n##   Rhdf5lib                 1.22.0    2023-04-25 [1] Bioconductor\n##   rlang                    1.1.1     2023-04-28 [1] CRAN (R 4.3.0)\n##   rmarkdown                2.23      2023-07-01 [1] CRAN (R 4.3.0)\n##   rmdformats               1.0.4     2022-05-17 [1] CRAN (R 4.3.0)\n##   RSpectra                 0.16-1    2022-04-24 [1] CRAN (R 4.3.0)\n##   RSQLite                  2.3.1     2023-04-03 [1] CRAN (R 4.3.0)\n##   rstudioapi               0.15.0    2023-07-07 [1] CRAN (R 4.3.0)\n##   S4Arrays                 1.0.5     2023-07-24 [1] Bioconductor\n##   S4Vectors                0.38.1    2023-05-02 [1] Bioconductor\n##   scales                   1.2.1     2022-08-20 [1] CRAN (R 4.3.0)\n##   sessioninfo              1.2.2     2021-12-06 [1] CRAN (R 4.3.0)\n##   shiny                    1.7.4.1   2023-07-06 [1] CRAN (R 4.3.0)\n##   strawr                   0.0.91    2023-03-29 [1] CRAN (R 4.3.0)\n##   stringi                  1.7.12    2023-01-11 [1] CRAN (R 4.3.0)\n##   stringr                  1.5.0     2022-12-02 [1] CRAN (R 4.3.0)\n##   SummarizedExperiment     1.30.2    2023-06-06 [1] Bioconductor\n##   tibble                   3.2.1     2023-03-20 [1] CRAN (R 4.3.0)\n##   tidyr                    1.3.0     2023-01-24 [1] CRAN (R 4.3.0)\n##   tidyselect               1.2.0     2022-10-10 [1] CRAN (R 4.3.0)\n##   tzdb                     0.4.0     2023-05-12 [1] CRAN (R 4.3.0)\n##   utf8                     1.2.3     2023-01-31 [1] CRAN (R 4.3.0)\n##   vctrs                    0.6.3     2023-06-14 [1] CRAN (R 4.3.0)\n##   vipor                    0.4.5     2017-03-22 [1] CRAN (R 4.3.0)\n##   viridisLite              0.4.2     2023-05-02 [1] CRAN (R 4.3.0)\n##   vroom                    1.6.3     2023-04-28 [1] CRAN (R 4.3.0)\n##   withr                    2.5.0     2022-03-03 [1] CRAN (R 4.3.0)\n##   xfun                     0.39      2023-04-20 [1] CRAN (R 4.3.0)\n##   xtable                   1.8-4     2019-04-21 [1] CRAN (R 4.3.0)\n##   XVector                  0.40.0    2023-04-25 [1] Bioconductor\n##   yaml                     2.3.7     2023-01-23 [1] CRAN (R 4.3.0)\n##   zlibbioc                 1.46.0    2023-04-25 [1] Bioconductor\n##  \n##   [1] /home/rsg/R/x86_64-pc-linux-gnu-library/4.3\n##   [2] /usr/local/lib/R-4.3/lib/R/library\n##  \n##  ───────────────────────────────────────────────────────────────────────────"
  },
  {
    "objectID": "parsing.html",
    "href": "parsing.html",
    "title": "Parsing Hi-C data in R",
    "section": "",
    "text": "Docker image\n\n\n\nAll the packages used in this demo are available in the following docker image:\n\n\n\nsh\n\ndocker run -it -e PASSWORD=OHCA -p 8787:8787 ghcr.io/js2264/ohca:bioc_RELEASE_3_17 R\n\n\nNote that this also opens up an RStudio instance available at https://localhost:8787/.\n\n\n\n\nA pair of fastq files can be parsed into .pairs and .(m)cool files with HiCool.\n\n\n\nR\n\nlibrary(HiCool)\nHiCool:::env_HiCool\n##  An object of class \"BasiliskEnvironment\"\n##  Slot \"envname\":\n##  [1] \"env\"\n##  \n##  Slot \"pkgname\":\n##  [1] \"HiCool\"\n##  \n##  Slot \"packages\":\n##  [1] \"python==3.8.10\"     \"bowtie2==2.5.0\"     \"samtools==1.16.1\"  \n##  [4] \"chromosight==1.6.3\" \"cooler==0.9.1\"     \n##  \n##  Slot \"channels\":\n##  [1] \"conda-forge\" \"bioconda\"   \n##  \n##  Slot \"pip\":\n##  [1] \"hicstuff==3.1.5\"\n##  \n##  Slot \"paths\":\n##  character(0)\n\n\n\n\n\n\n\n\nHiCool vs. hicstuff 👇\n\n\n\n\n\nHiCool mostly operates as a wrapper to the lightweight python-based hicstuff library. What HiCool really does is running hicstuff pipeline. You can replicate this outside of R console, directly in the terminal, by running:\n\n\n\nsh\n\nhicstuff pipeline \\\n   &lt;hicstuff-options&gt; \\\n   --genome &lt;genome.fa&gt; \\\n   &lt;input.R1.fq.gz&gt; \\\n   &lt;input.R2.fq.gz&gt; \n\n################################################################################\n##                     hicstuff important options                             ##\n################################################################################\n\nhicstuff pipeline --help\n\n##        -D | --duplicates         Filter out PCR duplicates based on read\n##                                  positions.\n##        -e | --enzyme={STR|INT}   Restriction enzyme or \"mnase\" if a string,\n##                                  or chunk size (i.e. resolution) if a number.\n##                                  Can also be multiple comma-separated\n##                                  enzymes. [default: 5000]\n##        -f | --filter             Filter out spurious 3C events (loops and\n##                                  uncuts) using hicstuff filter. Requires\n##                                  \"-e\" to be a restriction enzyme or mnase,\n##                                  not a chunk size. For more informations, see\n##                                  Cournac et al. BMC Genomics, 2012.\n##        -m | --mapping=STR        normal|iterative|cutsite. Parameter of\n##                                  mapping. \"normal\": Directly map reads\n##                                  without any process. \"iterative\": Map\n##                                  reads iteratively using iteralign, by\n##                                  truncating reads to 20bp and then\n##                                  repeatedly extending to align them.\n##                                  \"cutsite\": Cut reads at the religation\n##                                  sites of the given enzyme using cutsite,\n##                                  create new pairs of reads and then align\n##                                  them ; enzyme is required [default: normal].\n##        -M | --matfmt=STR         The format of the output sparse matrix.\n##                                  Can be \"bg2\" for 2D Bedgraph format,\n##                                  \"cool\" for Mirnylab's cooler software, or\n##                                  \"graal\" for graal-compatible plain text\n##                                  COO format. [default: graal]\n##        -n | --no-cleanup         If enabled, intermediary BED files will\n##                                  be kept after generating the contact map.\n##                                  Disabled by defaut.\n##        -o | --outdir=DIR         Output directory. Defaults to the current\n##                                  directory.\n##        -p | --plot               Generates plots in the output directory\n##                                  at different steps of the pipeline.\n##        -t | --threads=INT        Number of threads to allocate.\n##                                  [default: 1].\n\n\n\n\n\nA call to HiCool() triggers hicstuff pipeline to process fastq files into .pairs and .(m)cool files, and returns a CoolFile object in R, along with HTML reports.\n\n\n\nR\n\nlibrary(HiContactsData)\nr1 &lt;- HiContactsData(sample = 'yeast_wt', format = 'fastq_R1')\nr2 &lt;- HiContactsData(sample = 'yeast_wt', format = 'fastq_R2')\nhcf &lt;- HiCool(\n    r1, r2, \n    restriction = 'DpnII,HinfI', \n    genome = 'R64-1-1', \n    output = './HiCool/'\n)\n\n\n\nYou can check the generated output files placed in the HiCool/ directory.\n\nhcf &lt;- HiCool::importHiCoolFolder('results/HiCool', hash = 'LHMXWE')\nhcf\n##  CoolFile object\n##  .mcool file: results/HiCool/matrices/W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.mcool \n##  resolution: 1000 \n##  pairs file: results/HiCool/pairs/W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.pairs \n##  metadata(3): log args stats\nfs::dir_tree('results/HiCool/')\n##  results/HiCool/\n##  ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ.html\n##  ├── W303_G1_WT_rep1^mapped-W303^D0CIL5.html\n##  ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0.html\n##  ├── W303_G1_WT_rep2^mapped-W303^5PBKO1.html\n##  ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE.html\n##  ├── W303_G2M_WT_rep1^mapped-W303^64QFVP.html\n##  ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M.html\n##  ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR.html\n##  ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.html\n##  ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8.html\n##  ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.html\n##  ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH.html\n##  ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.html\n##  ├── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9.html\n##  ├── logs\n##  │   ├── CH02^mapped-S288c^KGQMIW.log\n##  │   ├── CH210^mapped-S288c^6EPKN5.log\n##  │   ├── SRR8769549_HiC-Seq_of_Saccharomyces_cerevisiae_W303_stopped_in_Metaphase_cdc20__1.fastq.gz^mapped-W303^PV86X8.log\n##  │   ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ.log\n##  │   ├── W303_G1_WT_rep1^mapped-W303^D0CIL5.log\n##  │   ├── W303_G1_WT_rep1^mapped-W303^TGGJSN.log\n##  │   ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0.log\n##  │   ├── W303_G1_WT_rep2^mapped-W303^1ED3LS.log\n##  │   ├── W303_G1_WT_rep2^mapped-W303^5PBKO1.log\n##  │   ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE.log\n##  │   ├── W303_G2M_WT_rep1^mapped-W303^64QFVP.log\n##  │   ├── W303_G2M_WT_rep1^mapped-W303^TC4PU1.log\n##  │   ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M.log\n##  │   ├── W303_G2M_WT_rep2^mapped-W303^MYJIMC.log\n##  │   ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR.log\n##  │   ├── W303_G2M_wpl1-eco1^mapped-S288c^ACRYQN.log\n##  │   ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.log\n##  │   ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8.log\n##  │   ├── W303_G2M_wpl1-eco1^mapped-W303^YJHY6K.log\n##  │   ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.log\n##  │   ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH.log\n##  │   ├── W303_G2M_wpl1_rep1^mapped-W303^MAU2XZ.log\n##  │   ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.log\n##  │   ├── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9.log\n##  │   └── W303_G2M_wpl1_rep2^mapped-W303^G72ANT.log\n##  ├── matrices\n##  │   ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ.mcool\n##  │   ├── W303_G1_WT_rep1^mapped-W303^D0CIL5.mcool\n##  │   ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0.mcool\n##  │   ├── W303_G1_WT_rep2^mapped-W303^5PBKO1.mcool\n##  │   ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE.mcool\n##  │   ├── W303_G2M_WT_rep1^mapped-W303^64QFVP.mcool\n##  │   ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M.mcool\n##  │   ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR.mcool\n##  │   ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.mcool\n##  │   ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8.mcool\n##  │   ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.mcool\n##  │   ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH.mcool\n##  │   ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.mcool\n##  │   └── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9.mcool\n##  ├── pairs\n##  │   ├── CH02^mapped-S288c^KGQMIW.pairs\n##  │   ├── CH210^mapped-S288c^6EPKN5.pairs\n##  │   ├── SRR8769549_HiC-Seq_of_Saccharomyces_cerevisiae_W303_stopped_in_Metaphase_cdc20__1.fastq.gz^mapped-W303^PV86X8.pairs\n##  │   ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ.pairs\n##  │   ├── W303_G1_WT_rep1^mapped-W303^D0CIL5.pairs\n##  │   ├── W303_G1_WT_rep1^mapped-W303^TGGJSN.pairs\n##  │   ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0.pairs\n##  │   ├── W303_G1_WT_rep2^mapped-W303^1ED3LS.pairs\n##  │   ├── W303_G1_WT_rep2^mapped-W303^5PBKO1.pairs\n##  │   ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE.pairs\n##  │   ├── W303_G2M_WT_rep1^mapped-W303^64QFVP.pairs\n##  │   ├── W303_G2M_WT_rep1^mapped-W303^TC4PU1.pairs\n##  │   ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M.pairs\n##  │   ├── W303_G2M_WT_rep2^mapped-W303^MYJIMC.pairs\n##  │   ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR.pairs\n##  │   ├── W303_G2M_wpl1-eco1^mapped-S288c^ACRYQN.pairs\n##  │   ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.pairs\n##  │   ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8.pairs\n##  │   ├── W303_G2M_wpl1-eco1^mapped-W303^YJHY6K.pairs\n##  │   ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.pairs\n##  │   ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH.pairs\n##  │   ├── W303_G2M_wpl1_rep1^mapped-W303^MAU2XZ.pairs\n##  │   ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.pairs\n##  │   ├── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9.pairs\n##  │   └── W303_G2M_wpl1_rep2^mapped-W303^G72ANT.pairs\n##  └── plots\n##      ├── CH02^mapped-S288c^KGQMIW_event_distance.pdf\n##      ├── CH02^mapped-S288c^KGQMIW_event_distribution.pdf\n##      ├── CH210^mapped-S288c^6EPKN5_event_distance.pdf\n##      ├── CH210^mapped-S288c^6EPKN5_event_distribution.pdf\n##      ├── SRR8769549_HiC-Seq_of_Saccharomyces_cerevisiae_W303_stopped_in_Metaphase_cdc20__1.fastq.gz^mapped-W303^PV86X8_event_distance.pdf\n##      ├── SRR8769549_HiC-Seq_of_Saccharomyces_cerevisiae_W303_stopped_in_Metaphase_cdc20__1.fastq.gz^mapped-W303^PV86X8_event_distribution.pdf\n##      ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ_event_distance.pdf\n##      ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ_event_distribution.pdf\n##      ├── W303_G1_WT_rep1^mapped-W303^D0CIL5_event_distance.pdf\n##      ├── W303_G1_WT_rep1^mapped-W303^D0CIL5_event_distribution.pdf\n##      ├── W303_G1_WT_rep1^mapped-W303^TGGJSN_event_distance.pdf\n##      ├── W303_G1_WT_rep1^mapped-W303^TGGJSN_event_distribution.pdf\n##      ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0_event_distance.pdf\n##      ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0_event_distribution.pdf\n##      ├── W303_G1_WT_rep2^mapped-W303^1ED3LS_event_distance.pdf\n##      ├── W303_G1_WT_rep2^mapped-W303^1ED3LS_event_distribution.pdf\n##      ├── W303_G1_WT_rep2^mapped-W303^5PBKO1_event_distance.pdf\n##      ├── W303_G1_WT_rep2^mapped-W303^5PBKO1_event_distribution.pdf\n##      ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE_event_distance.pdf\n##      ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE_event_distribution.pdf\n##      ├── W303_G2M_WT_rep1^mapped-W303^64QFVP_event_distance.pdf\n##      ├── W303_G2M_WT_rep1^mapped-W303^64QFVP_event_distribution.pdf\n##      ├── W303_G2M_WT_rep1^mapped-W303^TC4PU1_event_distance.pdf\n##      ├── W303_G2M_WT_rep1^mapped-W303^TC4PU1_event_distribution.pdf\n##      ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M_event_distance.pdf\n##      ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M_event_distribution.pdf\n##      ├── W303_G2M_WT_rep2^mapped-W303^MYJIMC_event_distance.pdf\n##      ├── W303_G2M_WT_rep2^mapped-W303^MYJIMC_event_distribution.pdf\n##      ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR_event_distance.pdf\n##      ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR_event_distribution.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-S288c^ACRYQN_event_distance.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-S288c^ACRYQN_event_distribution.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE_event_distance.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE_event_distribution.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8_event_distance.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8_event_distribution.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-W303^YJHY6K_event_distance.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-W303^YJHY6K_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z_event_distance.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH_event_distance.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-W303^MAU2XZ_event_distance.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-W303^MAU2XZ_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25_event_distance.pdf\n##      ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9_event_distance.pdf\n##      ├── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep2^mapped-W303^G72ANT_event_distance.pdf\n##      └── W303_G2M_wpl1_rep2^mapped-W303^G72ANT_event_distribution.pdf\n\n\nThe *.pairs and *.mcool files are the pairs and contact matrix files, respectively. These are the output files the end-user is generally looking for.\n\nThe *.html file is a report summarizing pairs numbers, filtering, etc…\nThe *.log file contains all output and error messages, as well as the full list of commands that have been executed to pre-process the input dataset.\nThe *.pdf graphic files provide a visual representation of the distribution of informative/non-informative pairs.\n\nA pointer to a local .(m)cool file (or .hic, HiC-Pro-style or .pairs file) can also be manually created:\n\n\n\nR\n\nlibrary(HiCExperiment)\nmcool &lt;- HiContactsData(sample = 'yeast_wt', format = 'mcool')\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nmcool\n##                                               EH7702 \n##  \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\"\navailableResolutions(mcool)\n##  resolutions(5): 1000 2000 4000 8000 16000\n##  \navailableChromosomes(mcool)\n##  Seqinfo object with 16 sequences from an unspecified genome:\n##    seqnames seqlengths isCircular genome\n##    I            230218       &lt;NA&gt;   &lt;NA&gt;\n##    II           813184       &lt;NA&gt;   &lt;NA&gt;\n##    III          316620       &lt;NA&gt;   &lt;NA&gt;\n##    IV          1531933       &lt;NA&gt;   &lt;NA&gt;\n##    V            576874       &lt;NA&gt;   &lt;NA&gt;\n##    ...             ...        ...    ...\n##    XII         1078177       &lt;NA&gt;   &lt;NA&gt;\n##    XIII         924431       &lt;NA&gt;   &lt;NA&gt;\n##    XIV          784333       &lt;NA&gt;   &lt;NA&gt;\n##    XV          1091291       &lt;NA&gt;   &lt;NA&gt;\n##    XVI          948066       &lt;NA&gt;   &lt;NA&gt;\ncf &lt;- CoolFile(mcool)\ncf\n##  CoolFile object\n##  .mcool file: /home/rsg/.cache/R/ExperimentHub/36d590c5583_7752 \n##  resolution: 1000 \n##  pairs file: \n##  metadata(0):\n\n\n\n\nA full contact map can be imported in R with import.\n\n\n\nR\n\nimport(cf)\n##  `HiCExperiment` object with 8,757,906 contacts over 12,079 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 2945692 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\n\n\nA specific resollution can be specified with the resolution:\n\n\n\nR\n\nimport(cf, resolution = 2000)\n##  `HiCExperiment` object with 8,757,906 contacts over 6,045 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 2198094 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\n\n\nA subset of the contact map can be imported in R by specifying a focus as a string:\n\n\n\nR\n\nimport(cf, focus = 'I')\n##  `HiCExperiment` object with 93,163 contacts over 231 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"I\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 11535 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\nimport(cf, focus = 'I:1-40000')\n##  `HiCExperiment` object with 9,803 contacts over 40 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"I:1-40,000\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 703 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\nimport(cf, focus = 'I|II')\n##  `HiCExperiment` object with 6,626 contacts over 1,045 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"I|II\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 6008 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\nimport(cf, focus = 'I:1-40000|II:2001-40000')\n##  `HiCExperiment` object with 68 contacts over 78 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"I:1-40000|II:2001-40000\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 62 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\n\n\nSubsetting can also be performed once the matrix has been loaded in memory:\n\n\n\nR\n\nlibrary(GenomicRanges)\nhic &lt;- import(cf)\nhic\n##  `HiCExperiment` object with 8,757,906 contacts over 12,079 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 2945692 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\nhic[\"I:1-40000\"]\n##  `HiCExperiment` object with 9,803 contacts over 38 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"I:1-40,000\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 703 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\n## or ...\nsubsetByOverlaps(hic, GRanges(\"I:1-40000\"))\n##  `HiCExperiment` object with 9,803 contacts over 38 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 703 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\n\n\n\n\n\n\nR\n\nshowClass(\"HiCExperiment\")\n##  Class \"HiCExperiment\" [package \"HiCExperiment\"]\n##  \n##  Slots:\n##                                                                    \n##  Name:             fileName               focus         resolutions\n##  Class:           character     characterOrNULL             numeric\n##                                                                    \n##  Name:           resolution        interactions              scores\n##  Class:             numeric       GInteractions          SimpleList\n##                                                                    \n##  Name:  topologicalFeatures           pairsFile            metadata\n##  Class:          SimpleList     characterOrNULL                list\n##  \n##  Extends: \"Annotated\"\n##  \n##  Known Subclasses: \"AggrHiCExperiment\"\n\n## -- Extract informations\nfileName(hic) \n##  [1] \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\"\nresolutions(hic) \n##  [1]  1000  2000  4000  8000 16000\nresolution(hic) \n##  [1] 1000\nseqinfo(hic) \n##  Seqinfo object with 16 sequences from an unspecified genome:\n##    seqnames seqlengths isCircular genome\n##    I            230218       &lt;NA&gt;   &lt;NA&gt;\n##    II           813184       &lt;NA&gt;   &lt;NA&gt;\n##    III          316620       &lt;NA&gt;   &lt;NA&gt;\n##    IV          1531933       &lt;NA&gt;   &lt;NA&gt;\n##    V            576874       &lt;NA&gt;   &lt;NA&gt;\n##    ...             ...        ...    ...\n##    XII         1078177       &lt;NA&gt;   &lt;NA&gt;\n##    XIII         924431       &lt;NA&gt;   &lt;NA&gt;\n##    XIV          784333       &lt;NA&gt;   &lt;NA&gt;\n##    XV          1091291       &lt;NA&gt;   &lt;NA&gt;\n##    XVI          948066       &lt;NA&gt;   &lt;NA&gt;\nmetadata(hic)\n##  list()\n\n## -- Extract data\ninteractions(hic)\n##  GInteractions object with 2945692 interactions and 4 metadata columns:\n##              seqnames1       ranges1     seqnames2       ranges2 |   bin_id1\n##                  &lt;Rle&gt;     &lt;IRanges&gt;         &lt;Rle&gt;     &lt;IRanges&gt; | &lt;numeric&gt;\n##          [1]         I        1-1000 ---         I        1-1000 |         0\n##          [2]         I        1-1000 ---         I     1001-2000 |         0\n##          [3]         I        1-1000 ---         I     2001-3000 |         0\n##          [4]         I        1-1000 ---         I     3001-4000 |         0\n##          [5]         I        1-1000 ---         I     4001-5000 |         0\n##          ...       ...           ... ...       ...           ... .       ...\n##    [2945688]       XVI 940001-941000 ---       XVI 942001-943000 |     12070\n##    [2945689]       XVI 940001-941000 ---       XVI 943001-944000 |     12070\n##    [2945690]       XVI 941001-942000 ---       XVI 941001-942000 |     12071\n##    [2945691]       XVI 941001-942000 ---       XVI 942001-943000 |     12071\n##    [2945692]       XVI 941001-942000 ---       XVI 943001-944000 |     12071\n##                bin_id2     count  balanced\n##              &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n##          [1]         0        15 0.0663491\n##          [2]         1        21 0.1273505\n##          [3]         2        21 0.0738691\n##          [4]         3        38 0.0827051\n##          [5]         4        17 0.0591984\n##          ...       ...       ...       ...\n##    [2945688]     12072        11 0.0575550\n##    [2945689]     12073         1       NaN\n##    [2945690]     12071        74 0.0504615\n##    [2945691]     12072        39 0.1624599\n##    [2945692]     12073         1       NaN\n##    -------\n##    regions: 12079 ranges and 4 metadata columns\n##    seqinfo: 16 sequences from an unspecified genome\nscores(hic)\n##  List of length 2\n##  names(2): count balanced\n\n## -- Extract extra data\ntopologicalFeatures(hic)\n##  List of length 4\n##  names(4): compartments borders loops viewpoints\npairsFile(hic)\n##  NULL\n\n\n\nRead the following sections from the OHCA book:\n\nHiCExperiment class presentation\nHiCExperiment class manipulation\n\n\n##  ─ Session info ────────────────────────────────────────────────────────────\n##   setting  value\n##   version  R version 4.3.0 (2023-04-21)\n##   os       Ubuntu 18.04.6 LTS\n##   system   x86_64, linux-gnu\n##   ui       X11\n##   language (EN)\n##   collate  en_US.UTF-8\n##   ctype    en_US.UTF-8\n##   tz       Europe/Paris\n##   date     2023-07-28\n##   pandoc   2.13 @ /usr/bin/ (via rmarkdown)\n##  \n##  ─ Packages ────────────────────────────────────────────────────────────────\n##   package                * version   date (UTC) lib source\n##   abind                    1.4-5     2016-07-21 [1] CRAN (R 4.3.0)\n##   AnnotationDbi            1.62.2    2023-07-02 [1] Bioconductor\n##   AnnotationHub          * 3.8.0     2023-04-25 [1] Bioconductor\n##   basilisk                 1.12.1    2023-06-30 [1] Bioconductor\n##   basilisk.utils           1.12.1    2023-05-19 [1] Bioconductor\n##   Biobase                  2.60.0    2023-04-25 [1] Bioconductor\n##   BiocFileCache          * 2.8.0     2023-04-25 [1] Bioconductor\n##   BiocGenerics           * 0.46.0    2023-04-25 [1] Bioconductor\n##   BiocIO                   1.10.0    2023-04-25 [1] Bioconductor\n##   BiocManager              1.30.21.1 2023-07-18 [1] CRAN (R 4.3.0)\n##   BiocParallel             1.34.2    2023-05-22 [1] Bioconductor\n##   BiocVersion              3.17.1    2022-11-04 [1] Bioconductor\n##   Biostrings               2.68.1    2023-05-16 [1] Bioconductor\n##   bit                      4.0.5     2022-11-15 [1] CRAN (R 4.3.0)\n##   bit64                    4.0.5     2020-08-30 [1] CRAN (R 4.3.0)\n##   bitops                   1.0-7     2021-04-24 [1] CRAN (R 4.3.0)\n##   blob                     1.2.4     2023-03-17 [1] CRAN (R 4.3.0)\n##   bookdown                 0.34      2023-05-09 [1] CRAN (R 4.3.0)\n##   cachem                   1.0.8     2023-05-01 [1] CRAN (R 4.3.0)\n##   cli                      3.6.1     2023-03-23 [1] CRAN (R 4.3.0)\n##   codetools                0.2-19    2023-02-01 [1] CRAN (R 4.3.0)\n##   colorspace               2.1-0     2023-01-23 [1] CRAN (R 4.3.0)\n##   crayon                   1.5.2     2022-09-29 [1] CRAN (R 4.3.0)\n##   curl                     5.0.1     2023-06-07 [1] CRAN (R 4.3.0)\n##   data.table               1.14.8    2023-02-17 [1] CRAN (R 4.3.0)\n##   DBI                      1.1.3     2022-06-18 [1] CRAN (R 4.3.0)\n##   dbplyr                 * 2.3.3     2023-07-07 [1] CRAN (R 4.3.0)\n##   DelayedArray             0.26.6    2023-07-02 [1] Bioconductor\n##   digest                   0.6.33    2023-07-07 [1] CRAN (R 4.3.0)\n##   dir.expiry               1.8.0     2023-04-25 [1] Bioconductor\n##   dplyr                    1.1.2     2023-04-20 [1] CRAN (R 4.3.0)\n##   ellipsis                 0.3.2     2021-04-29 [1] CRAN (R 4.3.0)\n##   evaluate                 0.21      2023-05-05 [1] CRAN (R 4.3.0)\n##   ExperimentHub          * 2.8.1     2023-07-12 [1] Bioconductor\n##   fansi                    1.0.4     2023-01-22 [1] CRAN (R 4.3.0)\n##   fastmap                  1.1.1     2023-02-24 [1] CRAN (R 4.3.0)\n##   filelock                 1.0.2     2018-10-05 [1] CRAN (R 4.3.0)\n##   generics                 0.1.3     2022-07-05 [1] CRAN (R 4.3.0)\n##   GenomeInfoDb           * 1.36.1    2023-06-21 [1] Bioconductor\n##   GenomeInfoDbData         1.2.10    2023-04-02 [1] Bioconductor\n##   GenomicRanges          * 1.52.0    2023-04-25 [1] Bioconductor\n##   ggplot2                  3.4.2     2023-04-03 [1] CRAN (R 4.3.0)\n##   glue                     1.6.2     2022-02-24 [1] CRAN (R 4.3.0)\n##   gtable                   0.3.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   HiCExperiment          * 1.1.1     2023-07-27 [1] Github (js2264/HiCExperiment@9e8f7bb)\n##   HiContactsData         * 1.3.0     2023-05-26 [1] Github (js2264/HiContactsData@adcb51f)\n##   HiCool                 * 1.1.0     2023-07-27 [1] local (/home/rsg/repos/HiCool)\n##   htmltools                0.5.5     2023-03-23 [1] CRAN (R 4.3.0)\n##   htmlwidgets              1.6.2     2023-03-17 [1] CRAN (R 4.3.0)\n##   httpuv                   1.6.11    2023-05-11 [1] CRAN (R 4.3.0)\n##   httr                     1.4.6     2023-05-08 [1] CRAN (R 4.3.0)\n##   InteractionSet           1.29.1    2023-06-13 [1] Github (LTLA/InteractionSet@62cd50a)\n##   interactiveDisplayBase   1.38.0    2023-04-25 [1] Bioconductor\n##   IRanges                * 2.34.1    2023-06-22 [1] Bioconductor\n##   jsonlite                 1.8.7     2023-06-29 [1] CRAN (R 4.3.0)\n##   KEGGREST                 1.40.0    2023-04-25 [1] Bioconductor\n##   knitr                    1.43      2023-05-25 [1] CRAN (R 4.3.0)\n##   later                    1.3.1     2023-05-02 [1] CRAN (R 4.3.0)\n##   lattice                  0.21-8    2023-04-05 [1] CRAN (R 4.3.0)\n##   lazyeval                 0.2.2     2019-03-15 [1] CRAN (R 4.3.0)\n##   lifecycle                1.0.3     2022-10-07 [1] CRAN (R 4.3.0)\n##   magrittr                 2.0.3     2022-03-30 [1] CRAN (R 4.3.0)\n##   Matrix                   1.6-0     2023-07-08 [1] CRAN (R 4.3.0)\n##   MatrixGenerics           1.12.2    2023-06-09 [1] Bioconductor\n##   matrixStats              1.0.0     2023-06-02 [1] CRAN (R 4.3.0)\n##   memoise                  2.0.1     2021-11-26 [1] CRAN (R 4.3.0)\n##   mime                     0.12      2021-09-28 [1] CRAN (R 4.3.0)\n##   munsell                  0.5.0     2018-06-12 [1] CRAN (R 4.3.0)\n##   pillar                   1.9.0     2023-03-22 [1] CRAN (R 4.3.0)\n##   pkgconfig                2.0.3     2019-09-22 [1] CRAN (R 4.3.0)\n##   plotly                   4.10.2    2023-06-03 [1] CRAN (R 4.3.0)\n##   png                      0.1-8     2022-11-29 [1] CRAN (R 4.3.0)\n##   promises                 1.2.0.1   2021-02-11 [1] CRAN (R 4.3.0)\n##   purrr                    1.0.1     2023-01-10 [1] CRAN (R 4.3.0)\n##   R6                       2.5.1     2021-08-19 [1] CRAN (R 4.3.0)\n##   rappdirs                 0.3.3     2021-01-31 [1] CRAN (R 4.3.0)\n##   Rcpp                     1.0.11    2023-07-06 [1] CRAN (R 4.3.0)\n##   RCurl                    1.98-1.12 2023-03-27 [1] CRAN (R 4.3.0)\n##   reticulate               1.30      2023-06-09 [1] CRAN (R 4.3.0)\n##   rhdf5                    2.44.0    2023-04-25 [1] Bioconductor\n##   rhdf5filters             1.12.1    2023-04-30 [1] Bioconductor\n##   Rhdf5lib                 1.22.0    2023-04-25 [1] Bioconductor\n##   rlang                    1.1.1     2023-04-28 [1] CRAN (R 4.3.0)\n##   rmarkdown                2.23      2023-07-01 [1] CRAN (R 4.3.0)\n##   rmdformats               1.0.4     2022-05-17 [1] CRAN (R 4.3.0)\n##   RSQLite                  2.3.1     2023-04-03 [1] CRAN (R 4.3.0)\n##   rstudioapi               0.15.0    2023-07-07 [1] CRAN (R 4.3.0)\n##   S4Arrays                 1.0.5     2023-07-24 [1] Bioconductor\n##   S4Vectors              * 0.38.1    2023-05-02 [1] Bioconductor\n##   scales                   1.2.1     2022-08-20 [1] CRAN (R 4.3.0)\n##   sessioninfo              1.2.2     2021-12-06 [1] CRAN (R 4.3.0)\n##   shiny                    1.7.4.1   2023-07-06 [1] CRAN (R 4.3.0)\n##   strawr                   0.0.91    2023-03-29 [1] CRAN (R 4.3.0)\n##   stringi                  1.7.12    2023-01-11 [1] CRAN (R 4.3.0)\n##   stringr                  1.5.0     2022-12-02 [1] CRAN (R 4.3.0)\n##   SummarizedExperiment     1.30.2    2023-06-06 [1] Bioconductor\n##   tibble                   3.2.1     2023-03-20 [1] CRAN (R 4.3.0)\n##   tidyr                    1.3.0     2023-01-24 [1] CRAN (R 4.3.0)\n##   tidyselect               1.2.0     2022-10-10 [1] CRAN (R 4.3.0)\n##   tzdb                     0.4.0     2023-05-12 [1] CRAN (R 4.3.0)\n##   utf8                     1.2.3     2023-01-31 [1] CRAN (R 4.3.0)\n##   vctrs                    0.6.3     2023-06-14 [1] CRAN (R 4.3.0)\n##   viridisLite              0.4.2     2023-05-02 [1] CRAN (R 4.3.0)\n##   vroom                    1.6.3     2023-04-28 [1] CRAN (R 4.3.0)\n##   xfun                     0.39      2023-04-20 [1] CRAN (R 4.3.0)\n##   xtable                   1.8-4     2019-04-21 [1] CRAN (R 4.3.0)\n##   XVector                  0.40.0    2023-04-25 [1] Bioconductor\n##   yaml                     2.3.7     2023-01-23 [1] CRAN (R 4.3.0)\n##   zlibbioc                 1.46.0    2023-04-25 [1] Bioconductor\n##  \n##   [1] /home/rsg/R/x86_64-pc-linux-gnu-library/4.3\n##   [2] /usr/local/lib/R-4.3/lib/R/library\n##  \n##  ───────────────────────────────────────────────────────────────────────────"
  },
  {
    "objectID": "parsing.html#processing-hi-c-paired-end-reads-in-r",
    "href": "parsing.html#processing-hi-c-paired-end-reads-in-r",
    "title": "Parsing Hi-C data in R",
    "section": "",
    "text": "A pair of fastq files can be parsed into .pairs and .(m)cool files with HiCool.\n\n\n\nR\n\nlibrary(HiCool)\nHiCool:::env_HiCool\n##  An object of class \"BasiliskEnvironment\"\n##  Slot \"envname\":\n##  [1] \"env\"\n##  \n##  Slot \"pkgname\":\n##  [1] \"HiCool\"\n##  \n##  Slot \"packages\":\n##  [1] \"python==3.8.10\"     \"bowtie2==2.5.0\"     \"samtools==1.16.1\"  \n##  [4] \"chromosight==1.6.3\" \"cooler==0.9.1\"     \n##  \n##  Slot \"channels\":\n##  [1] \"conda-forge\" \"bioconda\"   \n##  \n##  Slot \"pip\":\n##  [1] \"hicstuff==3.1.5\"\n##  \n##  Slot \"paths\":\n##  character(0)\n\n\n\n\n\n\n\n\nHiCool vs. hicstuff 👇\n\n\n\n\n\nHiCool mostly operates as a wrapper to the lightweight python-based hicstuff library. What HiCool really does is running hicstuff pipeline. You can replicate this outside of R console, directly in the terminal, by running:\n\n\n\nsh\n\nhicstuff pipeline \\\n   &lt;hicstuff-options&gt; \\\n   --genome &lt;genome.fa&gt; \\\n   &lt;input.R1.fq.gz&gt; \\\n   &lt;input.R2.fq.gz&gt; \n\n################################################################################\n##                     hicstuff important options                             ##\n################################################################################\n\nhicstuff pipeline --help\n\n##        -D | --duplicates         Filter out PCR duplicates based on read\n##                                  positions.\n##        -e | --enzyme={STR|INT}   Restriction enzyme or \"mnase\" if a string,\n##                                  or chunk size (i.e. resolution) if a number.\n##                                  Can also be multiple comma-separated\n##                                  enzymes. [default: 5000]\n##        -f | --filter             Filter out spurious 3C events (loops and\n##                                  uncuts) using hicstuff filter. Requires\n##                                  \"-e\" to be a restriction enzyme or mnase,\n##                                  not a chunk size. For more informations, see\n##                                  Cournac et al. BMC Genomics, 2012.\n##        -m | --mapping=STR        normal|iterative|cutsite. Parameter of\n##                                  mapping. \"normal\": Directly map reads\n##                                  without any process. \"iterative\": Map\n##                                  reads iteratively using iteralign, by\n##                                  truncating reads to 20bp and then\n##                                  repeatedly extending to align them.\n##                                  \"cutsite\": Cut reads at the religation\n##                                  sites of the given enzyme using cutsite,\n##                                  create new pairs of reads and then align\n##                                  them ; enzyme is required [default: normal].\n##        -M | --matfmt=STR         The format of the output sparse matrix.\n##                                  Can be \"bg2\" for 2D Bedgraph format,\n##                                  \"cool\" for Mirnylab's cooler software, or\n##                                  \"graal\" for graal-compatible plain text\n##                                  COO format. [default: graal]\n##        -n | --no-cleanup         If enabled, intermediary BED files will\n##                                  be kept after generating the contact map.\n##                                  Disabled by defaut.\n##        -o | --outdir=DIR         Output directory. Defaults to the current\n##                                  directory.\n##        -p | --plot               Generates plots in the output directory\n##                                  at different steps of the pipeline.\n##        -t | --threads=INT        Number of threads to allocate.\n##                                  [default: 1].\n\n\n\n\n\nA call to HiCool() triggers hicstuff pipeline to process fastq files into .pairs and .(m)cool files, and returns a CoolFile object in R, along with HTML reports.\n\n\n\nR\n\nlibrary(HiContactsData)\nr1 &lt;- HiContactsData(sample = 'yeast_wt', format = 'fastq_R1')\nr2 &lt;- HiContactsData(sample = 'yeast_wt', format = 'fastq_R2')\nhcf &lt;- HiCool(\n    r1, r2, \n    restriction = 'DpnII,HinfI', \n    genome = 'R64-1-1', \n    output = './HiCool/'\n)\n\n\n\nYou can check the generated output files placed in the HiCool/ directory.\n\nhcf &lt;- HiCool::importHiCoolFolder('results/HiCool', hash = 'LHMXWE')\nhcf\n##  CoolFile object\n##  .mcool file: results/HiCool/matrices/W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.mcool \n##  resolution: 1000 \n##  pairs file: results/HiCool/pairs/W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.pairs \n##  metadata(3): log args stats\nfs::dir_tree('results/HiCool/')\n##  results/HiCool/\n##  ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ.html\n##  ├── W303_G1_WT_rep1^mapped-W303^D0CIL5.html\n##  ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0.html\n##  ├── W303_G1_WT_rep2^mapped-W303^5PBKO1.html\n##  ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE.html\n##  ├── W303_G2M_WT_rep1^mapped-W303^64QFVP.html\n##  ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M.html\n##  ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR.html\n##  ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.html\n##  ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8.html\n##  ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.html\n##  ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH.html\n##  ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.html\n##  ├── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9.html\n##  ├── logs\n##  │   ├── CH02^mapped-S288c^KGQMIW.log\n##  │   ├── CH210^mapped-S288c^6EPKN5.log\n##  │   ├── SRR8769549_HiC-Seq_of_Saccharomyces_cerevisiae_W303_stopped_in_Metaphase_cdc20__1.fastq.gz^mapped-W303^PV86X8.log\n##  │   ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ.log\n##  │   ├── W303_G1_WT_rep1^mapped-W303^D0CIL5.log\n##  │   ├── W303_G1_WT_rep1^mapped-W303^TGGJSN.log\n##  │   ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0.log\n##  │   ├── W303_G1_WT_rep2^mapped-W303^1ED3LS.log\n##  │   ├── W303_G1_WT_rep2^mapped-W303^5PBKO1.log\n##  │   ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE.log\n##  │   ├── W303_G2M_WT_rep1^mapped-W303^64QFVP.log\n##  │   ├── W303_G2M_WT_rep1^mapped-W303^TC4PU1.log\n##  │   ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M.log\n##  │   ├── W303_G2M_WT_rep2^mapped-W303^MYJIMC.log\n##  │   ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR.log\n##  │   ├── W303_G2M_wpl1-eco1^mapped-S288c^ACRYQN.log\n##  │   ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.log\n##  │   ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8.log\n##  │   ├── W303_G2M_wpl1-eco1^mapped-W303^YJHY6K.log\n##  │   ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.log\n##  │   ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH.log\n##  │   ├── W303_G2M_wpl1_rep1^mapped-W303^MAU2XZ.log\n##  │   ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.log\n##  │   ├── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9.log\n##  │   └── W303_G2M_wpl1_rep2^mapped-W303^G72ANT.log\n##  ├── matrices\n##  │   ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ.mcool\n##  │   ├── W303_G1_WT_rep1^mapped-W303^D0CIL5.mcool\n##  │   ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0.mcool\n##  │   ├── W303_G1_WT_rep2^mapped-W303^5PBKO1.mcool\n##  │   ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE.mcool\n##  │   ├── W303_G2M_WT_rep1^mapped-W303^64QFVP.mcool\n##  │   ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M.mcool\n##  │   ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR.mcool\n##  │   ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.mcool\n##  │   ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8.mcool\n##  │   ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.mcool\n##  │   ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH.mcool\n##  │   ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.mcool\n##  │   └── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9.mcool\n##  ├── pairs\n##  │   ├── CH02^mapped-S288c^KGQMIW.pairs\n##  │   ├── CH210^mapped-S288c^6EPKN5.pairs\n##  │   ├── SRR8769549_HiC-Seq_of_Saccharomyces_cerevisiae_W303_stopped_in_Metaphase_cdc20__1.fastq.gz^mapped-W303^PV86X8.pairs\n##  │   ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ.pairs\n##  │   ├── W303_G1_WT_rep1^mapped-W303^D0CIL5.pairs\n##  │   ├── W303_G1_WT_rep1^mapped-W303^TGGJSN.pairs\n##  │   ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0.pairs\n##  │   ├── W303_G1_WT_rep2^mapped-W303^1ED3LS.pairs\n##  │   ├── W303_G1_WT_rep2^mapped-W303^5PBKO1.pairs\n##  │   ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE.pairs\n##  │   ├── W303_G2M_WT_rep1^mapped-W303^64QFVP.pairs\n##  │   ├── W303_G2M_WT_rep1^mapped-W303^TC4PU1.pairs\n##  │   ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M.pairs\n##  │   ├── W303_G2M_WT_rep2^mapped-W303^MYJIMC.pairs\n##  │   ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR.pairs\n##  │   ├── W303_G2M_wpl1-eco1^mapped-S288c^ACRYQN.pairs\n##  │   ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE.pairs\n##  │   ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8.pairs\n##  │   ├── W303_G2M_wpl1-eco1^mapped-W303^YJHY6K.pairs\n##  │   ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z.pairs\n##  │   ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH.pairs\n##  │   ├── W303_G2M_wpl1_rep1^mapped-W303^MAU2XZ.pairs\n##  │   ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25.pairs\n##  │   ├── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9.pairs\n##  │   └── W303_G2M_wpl1_rep2^mapped-W303^G72ANT.pairs\n##  └── plots\n##      ├── CH02^mapped-S288c^KGQMIW_event_distance.pdf\n##      ├── CH02^mapped-S288c^KGQMIW_event_distribution.pdf\n##      ├── CH210^mapped-S288c^6EPKN5_event_distance.pdf\n##      ├── CH210^mapped-S288c^6EPKN5_event_distribution.pdf\n##      ├── SRR8769549_HiC-Seq_of_Saccharomyces_cerevisiae_W303_stopped_in_Metaphase_cdc20__1.fastq.gz^mapped-W303^PV86X8_event_distance.pdf\n##      ├── SRR8769549_HiC-Seq_of_Saccharomyces_cerevisiae_W303_stopped_in_Metaphase_cdc20__1.fastq.gz^mapped-W303^PV86X8_event_distribution.pdf\n##      ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ_event_distance.pdf\n##      ├── W303_G1_WT_rep1^mapped-S288c^GK8ISZ_event_distribution.pdf\n##      ├── W303_G1_WT_rep1^mapped-W303^D0CIL5_event_distance.pdf\n##      ├── W303_G1_WT_rep1^mapped-W303^D0CIL5_event_distribution.pdf\n##      ├── W303_G1_WT_rep1^mapped-W303^TGGJSN_event_distance.pdf\n##      ├── W303_G1_WT_rep1^mapped-W303^TGGJSN_event_distribution.pdf\n##      ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0_event_distance.pdf\n##      ├── W303_G1_WT_rep2^mapped-S288c^SWZTO0_event_distribution.pdf\n##      ├── W303_G1_WT_rep2^mapped-W303^1ED3LS_event_distance.pdf\n##      ├── W303_G1_WT_rep2^mapped-W303^1ED3LS_event_distribution.pdf\n##      ├── W303_G1_WT_rep2^mapped-W303^5PBKO1_event_distance.pdf\n##      ├── W303_G1_WT_rep2^mapped-W303^5PBKO1_event_distribution.pdf\n##      ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE_event_distance.pdf\n##      ├── W303_G2M_WT_rep1^mapped-S288c^3KHHUE_event_distribution.pdf\n##      ├── W303_G2M_WT_rep1^mapped-W303^64QFVP_event_distance.pdf\n##      ├── W303_G2M_WT_rep1^mapped-W303^64QFVP_event_distribution.pdf\n##      ├── W303_G2M_WT_rep1^mapped-W303^TC4PU1_event_distance.pdf\n##      ├── W303_G2M_WT_rep1^mapped-W303^TC4PU1_event_distribution.pdf\n##      ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M_event_distance.pdf\n##      ├── W303_G2M_WT_rep2^mapped-S288c^UVNG7M_event_distribution.pdf\n##      ├── W303_G2M_WT_rep2^mapped-W303^MYJIMC_event_distance.pdf\n##      ├── W303_G2M_WT_rep2^mapped-W303^MYJIMC_event_distribution.pdf\n##      ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR_event_distance.pdf\n##      ├── W303_G2M_WT_rep2^mapped-W303^X2H3FR_event_distribution.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-S288c^ACRYQN_event_distance.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-S288c^ACRYQN_event_distribution.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE_event_distance.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-S288c^LHMXWE_event_distribution.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8_event_distance.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-W303^ESZ2C8_event_distribution.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-W303^YJHY6K_event_distance.pdf\n##      ├── W303_G2M_wpl1-eco1^mapped-W303^YJHY6K_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z_event_distance.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-S288c^Q4KX6Z_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH_event_distance.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-W303^3445YH_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-W303^MAU2XZ_event_distance.pdf\n##      ├── W303_G2M_wpl1_rep1^mapped-W303^MAU2XZ_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25_event_distance.pdf\n##      ├── W303_G2M_wpl1_rep2^mapped-S288c^3N0L25_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9_event_distance.pdf\n##      ├── W303_G2M_wpl1_rep2^mapped-W303^ET4BQ9_event_distribution.pdf\n##      ├── W303_G2M_wpl1_rep2^mapped-W303^G72ANT_event_distance.pdf\n##      └── W303_G2M_wpl1_rep2^mapped-W303^G72ANT_event_distribution.pdf\n\n\nThe *.pairs and *.mcool files are the pairs and contact matrix files, respectively. These are the output files the end-user is generally looking for.\n\nThe *.html file is a report summarizing pairs numbers, filtering, etc…\nThe *.log file contains all output and error messages, as well as the full list of commands that have been executed to pre-process the input dataset.\nThe *.pdf graphic files provide a visual representation of the distribution of informative/non-informative pairs.\n\nA pointer to a local .(m)cool file (or .hic, HiC-Pro-style or .pairs file) can also be manually created:\n\n\n\nR\n\nlibrary(HiCExperiment)\nmcool &lt;- HiContactsData(sample = 'yeast_wt', format = 'mcool')\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nmcool\n##                                               EH7702 \n##  \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\"\navailableResolutions(mcool)\n##  resolutions(5): 1000 2000 4000 8000 16000\n##  \navailableChromosomes(mcool)\n##  Seqinfo object with 16 sequences from an unspecified genome:\n##    seqnames seqlengths isCircular genome\n##    I            230218       &lt;NA&gt;   &lt;NA&gt;\n##    II           813184       &lt;NA&gt;   &lt;NA&gt;\n##    III          316620       &lt;NA&gt;   &lt;NA&gt;\n##    IV          1531933       &lt;NA&gt;   &lt;NA&gt;\n##    V            576874       &lt;NA&gt;   &lt;NA&gt;\n##    ...             ...        ...    ...\n##    XII         1078177       &lt;NA&gt;   &lt;NA&gt;\n##    XIII         924431       &lt;NA&gt;   &lt;NA&gt;\n##    XIV          784333       &lt;NA&gt;   &lt;NA&gt;\n##    XV          1091291       &lt;NA&gt;   &lt;NA&gt;\n##    XVI          948066       &lt;NA&gt;   &lt;NA&gt;\ncf &lt;- CoolFile(mcool)\ncf\n##  CoolFile object\n##  .mcool file: /home/rsg/.cache/R/ExperimentHub/36d590c5583_7752 \n##  resolution: 1000 \n##  pairs file: \n##  metadata(0):"
  },
  {
    "objectID": "parsing.html#importing-hi-c-contact-maps-in-r",
    "href": "parsing.html#importing-hi-c-contact-maps-in-r",
    "title": "Parsing Hi-C data in R",
    "section": "",
    "text": "A full contact map can be imported in R with import.\n\n\n\nR\n\nimport(cf)\n##  `HiCExperiment` object with 8,757,906 contacts over 12,079 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 2945692 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\n\n\nA specific resollution can be specified with the resolution:\n\n\n\nR\n\nimport(cf, resolution = 2000)\n##  `HiCExperiment` object with 8,757,906 contacts over 6,045 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 2198094 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\n\n\nA subset of the contact map can be imported in R by specifying a focus as a string:\n\n\n\nR\n\nimport(cf, focus = 'I')\n##  `HiCExperiment` object with 93,163 contacts over 231 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"I\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 11535 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\nimport(cf, focus = 'I:1-40000')\n##  `HiCExperiment` object with 9,803 contacts over 40 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"I:1-40,000\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 703 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\nimport(cf, focus = 'I|II')\n##  `HiCExperiment` object with 6,626 contacts over 1,045 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"I|II\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 6008 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\nimport(cf, focus = 'I:1-40000|II:2001-40000')\n##  `HiCExperiment` object with 68 contacts over 78 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"I:1-40000|II:2001-40000\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 62 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\n\n\nSubsetting can also be performed once the matrix has been loaded in memory:\n\n\n\nR\n\nlibrary(GenomicRanges)\nhic &lt;- import(cf)\nhic\n##  `HiCExperiment` object with 8,757,906 contacts over 12,079 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 2945692 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\nhic[\"I:1-40000\"]\n##  `HiCExperiment` object with 9,803 contacts over 38 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"I:1-40,000\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 703 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\n## or ...\nsubsetByOverlaps(hic, GRanges(\"I:1-40000\"))\n##  `HiCExperiment` object with 9,803 contacts over 38 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"whole genome\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 1000 \n##  interactions: 703 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\n\n\n\n\n\n\nR\n\nshowClass(\"HiCExperiment\")\n##  Class \"HiCExperiment\" [package \"HiCExperiment\"]\n##  \n##  Slots:\n##                                                                    \n##  Name:             fileName               focus         resolutions\n##  Class:           character     characterOrNULL             numeric\n##                                                                    \n##  Name:           resolution        interactions              scores\n##  Class:             numeric       GInteractions          SimpleList\n##                                                                    \n##  Name:  topologicalFeatures           pairsFile            metadata\n##  Class:          SimpleList     characterOrNULL                list\n##  \n##  Extends: \"Annotated\"\n##  \n##  Known Subclasses: \"AggrHiCExperiment\"\n\n## -- Extract informations\nfileName(hic) \n##  [1] \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\"\nresolutions(hic) \n##  [1]  1000  2000  4000  8000 16000\nresolution(hic) \n##  [1] 1000\nseqinfo(hic) \n##  Seqinfo object with 16 sequences from an unspecified genome:\n##    seqnames seqlengths isCircular genome\n##    I            230218       &lt;NA&gt;   &lt;NA&gt;\n##    II           813184       &lt;NA&gt;   &lt;NA&gt;\n##    III          316620       &lt;NA&gt;   &lt;NA&gt;\n##    IV          1531933       &lt;NA&gt;   &lt;NA&gt;\n##    V            576874       &lt;NA&gt;   &lt;NA&gt;\n##    ...             ...        ...    ...\n##    XII         1078177       &lt;NA&gt;   &lt;NA&gt;\n##    XIII         924431       &lt;NA&gt;   &lt;NA&gt;\n##    XIV          784333       &lt;NA&gt;   &lt;NA&gt;\n##    XV          1091291       &lt;NA&gt;   &lt;NA&gt;\n##    XVI          948066       &lt;NA&gt;   &lt;NA&gt;\nmetadata(hic)\n##  list()\n\n## -- Extract data\ninteractions(hic)\n##  GInteractions object with 2945692 interactions and 4 metadata columns:\n##              seqnames1       ranges1     seqnames2       ranges2 |   bin_id1\n##                  &lt;Rle&gt;     &lt;IRanges&gt;         &lt;Rle&gt;     &lt;IRanges&gt; | &lt;numeric&gt;\n##          [1]         I        1-1000 ---         I        1-1000 |         0\n##          [2]         I        1-1000 ---         I     1001-2000 |         0\n##          [3]         I        1-1000 ---         I     2001-3000 |         0\n##          [4]         I        1-1000 ---         I     3001-4000 |         0\n##          [5]         I        1-1000 ---         I     4001-5000 |         0\n##          ...       ...           ... ...       ...           ... .       ...\n##    [2945688]       XVI 940001-941000 ---       XVI 942001-943000 |     12070\n##    [2945689]       XVI 940001-941000 ---       XVI 943001-944000 |     12070\n##    [2945690]       XVI 941001-942000 ---       XVI 941001-942000 |     12071\n##    [2945691]       XVI 941001-942000 ---       XVI 942001-943000 |     12071\n##    [2945692]       XVI 941001-942000 ---       XVI 943001-944000 |     12071\n##                bin_id2     count  balanced\n##              &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n##          [1]         0        15 0.0663491\n##          [2]         1        21 0.1273505\n##          [3]         2        21 0.0738691\n##          [4]         3        38 0.0827051\n##          [5]         4        17 0.0591984\n##          ...       ...       ...       ...\n##    [2945688]     12072        11 0.0575550\n##    [2945689]     12073         1       NaN\n##    [2945690]     12071        74 0.0504615\n##    [2945691]     12072        39 0.1624599\n##    [2945692]     12073         1       NaN\n##    -------\n##    regions: 12079 ranges and 4 metadata columns\n##    seqinfo: 16 sequences from an unspecified genome\nscores(hic)\n##  List of length 2\n##  names(2): count balanced\n\n## -- Extract extra data\ntopologicalFeatures(hic)\n##  List of length 4\n##  names(4): compartments borders loops viewpoints\npairsFile(hic)\n##  NULL"
  },
  {
    "objectID": "parsing.html#read-more",
    "href": "parsing.html#read-more",
    "title": "Parsing Hi-C data in R",
    "section": "",
    "text": "Read the following sections from the OHCA book:\n\nHiCExperiment class presentation\nHiCExperiment class manipulation"
  },
  {
    "objectID": "parsing.html#session-info",
    "href": "parsing.html#session-info",
    "title": "Parsing Hi-C data in R",
    "section": "",
    "text": "##  ─ Session info ────────────────────────────────────────────────────────────\n##   setting  value\n##   version  R version 4.3.0 (2023-04-21)\n##   os       Ubuntu 18.04.6 LTS\n##   system   x86_64, linux-gnu\n##   ui       X11\n##   language (EN)\n##   collate  en_US.UTF-8\n##   ctype    en_US.UTF-8\n##   tz       Europe/Paris\n##   date     2023-07-28\n##   pandoc   2.13 @ /usr/bin/ (via rmarkdown)\n##  \n##  ─ Packages ────────────────────────────────────────────────────────────────\n##   package                * version   date (UTC) lib source\n##   abind                    1.4-5     2016-07-21 [1] CRAN (R 4.3.0)\n##   AnnotationDbi            1.62.2    2023-07-02 [1] Bioconductor\n##   AnnotationHub          * 3.8.0     2023-04-25 [1] Bioconductor\n##   basilisk                 1.12.1    2023-06-30 [1] Bioconductor\n##   basilisk.utils           1.12.1    2023-05-19 [1] Bioconductor\n##   Biobase                  2.60.0    2023-04-25 [1] Bioconductor\n##   BiocFileCache          * 2.8.0     2023-04-25 [1] Bioconductor\n##   BiocGenerics           * 0.46.0    2023-04-25 [1] Bioconductor\n##   BiocIO                   1.10.0    2023-04-25 [1] Bioconductor\n##   BiocManager              1.30.21.1 2023-07-18 [1] CRAN (R 4.3.0)\n##   BiocParallel             1.34.2    2023-05-22 [1] Bioconductor\n##   BiocVersion              3.17.1    2022-11-04 [1] Bioconductor\n##   Biostrings               2.68.1    2023-05-16 [1] Bioconductor\n##   bit                      4.0.5     2022-11-15 [1] CRAN (R 4.3.0)\n##   bit64                    4.0.5     2020-08-30 [1] CRAN (R 4.3.0)\n##   bitops                   1.0-7     2021-04-24 [1] CRAN (R 4.3.0)\n##   blob                     1.2.4     2023-03-17 [1] CRAN (R 4.3.0)\n##   bookdown                 0.34      2023-05-09 [1] CRAN (R 4.3.0)\n##   cachem                   1.0.8     2023-05-01 [1] CRAN (R 4.3.0)\n##   cli                      3.6.1     2023-03-23 [1] CRAN (R 4.3.0)\n##   codetools                0.2-19    2023-02-01 [1] CRAN (R 4.3.0)\n##   colorspace               2.1-0     2023-01-23 [1] CRAN (R 4.3.0)\n##   crayon                   1.5.2     2022-09-29 [1] CRAN (R 4.3.0)\n##   curl                     5.0.1     2023-06-07 [1] CRAN (R 4.3.0)\n##   data.table               1.14.8    2023-02-17 [1] CRAN (R 4.3.0)\n##   DBI                      1.1.3     2022-06-18 [1] CRAN (R 4.3.0)\n##   dbplyr                 * 2.3.3     2023-07-07 [1] CRAN (R 4.3.0)\n##   DelayedArray             0.26.6    2023-07-02 [1] Bioconductor\n##   digest                   0.6.33    2023-07-07 [1] CRAN (R 4.3.0)\n##   dir.expiry               1.8.0     2023-04-25 [1] Bioconductor\n##   dplyr                    1.1.2     2023-04-20 [1] CRAN (R 4.3.0)\n##   ellipsis                 0.3.2     2021-04-29 [1] CRAN (R 4.3.0)\n##   evaluate                 0.21      2023-05-05 [1] CRAN (R 4.3.0)\n##   ExperimentHub          * 2.8.1     2023-07-12 [1] Bioconductor\n##   fansi                    1.0.4     2023-01-22 [1] CRAN (R 4.3.0)\n##   fastmap                  1.1.1     2023-02-24 [1] CRAN (R 4.3.0)\n##   filelock                 1.0.2     2018-10-05 [1] CRAN (R 4.3.0)\n##   generics                 0.1.3     2022-07-05 [1] CRAN (R 4.3.0)\n##   GenomeInfoDb           * 1.36.1    2023-06-21 [1] Bioconductor\n##   GenomeInfoDbData         1.2.10    2023-04-02 [1] Bioconductor\n##   GenomicRanges          * 1.52.0    2023-04-25 [1] Bioconductor\n##   ggplot2                  3.4.2     2023-04-03 [1] CRAN (R 4.3.0)\n##   glue                     1.6.2     2022-02-24 [1] CRAN (R 4.3.0)\n##   gtable                   0.3.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   HiCExperiment          * 1.1.1     2023-07-27 [1] Github (js2264/HiCExperiment@9e8f7bb)\n##   HiContactsData         * 1.3.0     2023-05-26 [1] Github (js2264/HiContactsData@adcb51f)\n##   HiCool                 * 1.1.0     2023-07-27 [1] local (/home/rsg/repos/HiCool)\n##   htmltools                0.5.5     2023-03-23 [1] CRAN (R 4.3.0)\n##   htmlwidgets              1.6.2     2023-03-17 [1] CRAN (R 4.3.0)\n##   httpuv                   1.6.11    2023-05-11 [1] CRAN (R 4.3.0)\n##   httr                     1.4.6     2023-05-08 [1] CRAN (R 4.3.0)\n##   InteractionSet           1.29.1    2023-06-13 [1] Github (LTLA/InteractionSet@62cd50a)\n##   interactiveDisplayBase   1.38.0    2023-04-25 [1] Bioconductor\n##   IRanges                * 2.34.1    2023-06-22 [1] Bioconductor\n##   jsonlite                 1.8.7     2023-06-29 [1] CRAN (R 4.3.0)\n##   KEGGREST                 1.40.0    2023-04-25 [1] Bioconductor\n##   knitr                    1.43      2023-05-25 [1] CRAN (R 4.3.0)\n##   later                    1.3.1     2023-05-02 [1] CRAN (R 4.3.0)\n##   lattice                  0.21-8    2023-04-05 [1] CRAN (R 4.3.0)\n##   lazyeval                 0.2.2     2019-03-15 [1] CRAN (R 4.3.0)\n##   lifecycle                1.0.3     2022-10-07 [1] CRAN (R 4.3.0)\n##   magrittr                 2.0.3     2022-03-30 [1] CRAN (R 4.3.0)\n##   Matrix                   1.6-0     2023-07-08 [1] CRAN (R 4.3.0)\n##   MatrixGenerics           1.12.2    2023-06-09 [1] Bioconductor\n##   matrixStats              1.0.0     2023-06-02 [1] CRAN (R 4.3.0)\n##   memoise                  2.0.1     2021-11-26 [1] CRAN (R 4.3.0)\n##   mime                     0.12      2021-09-28 [1] CRAN (R 4.3.0)\n##   munsell                  0.5.0     2018-06-12 [1] CRAN (R 4.3.0)\n##   pillar                   1.9.0     2023-03-22 [1] CRAN (R 4.3.0)\n##   pkgconfig                2.0.3     2019-09-22 [1] CRAN (R 4.3.0)\n##   plotly                   4.10.2    2023-06-03 [1] CRAN (R 4.3.0)\n##   png                      0.1-8     2022-11-29 [1] CRAN (R 4.3.0)\n##   promises                 1.2.0.1   2021-02-11 [1] CRAN (R 4.3.0)\n##   purrr                    1.0.1     2023-01-10 [1] CRAN (R 4.3.0)\n##   R6                       2.5.1     2021-08-19 [1] CRAN (R 4.3.0)\n##   rappdirs                 0.3.3     2021-01-31 [1] CRAN (R 4.3.0)\n##   Rcpp                     1.0.11    2023-07-06 [1] CRAN (R 4.3.0)\n##   RCurl                    1.98-1.12 2023-03-27 [1] CRAN (R 4.3.0)\n##   reticulate               1.30      2023-06-09 [1] CRAN (R 4.3.0)\n##   rhdf5                    2.44.0    2023-04-25 [1] Bioconductor\n##   rhdf5filters             1.12.1    2023-04-30 [1] Bioconductor\n##   Rhdf5lib                 1.22.0    2023-04-25 [1] Bioconductor\n##   rlang                    1.1.1     2023-04-28 [1] CRAN (R 4.3.0)\n##   rmarkdown                2.23      2023-07-01 [1] CRAN (R 4.3.0)\n##   rmdformats               1.0.4     2022-05-17 [1] CRAN (R 4.3.0)\n##   RSQLite                  2.3.1     2023-04-03 [1] CRAN (R 4.3.0)\n##   rstudioapi               0.15.0    2023-07-07 [1] CRAN (R 4.3.0)\n##   S4Arrays                 1.0.5     2023-07-24 [1] Bioconductor\n##   S4Vectors              * 0.38.1    2023-05-02 [1] Bioconductor\n##   scales                   1.2.1     2022-08-20 [1] CRAN (R 4.3.0)\n##   sessioninfo              1.2.2     2021-12-06 [1] CRAN (R 4.3.0)\n##   shiny                    1.7.4.1   2023-07-06 [1] CRAN (R 4.3.0)\n##   strawr                   0.0.91    2023-03-29 [1] CRAN (R 4.3.0)\n##   stringi                  1.7.12    2023-01-11 [1] CRAN (R 4.3.0)\n##   stringr                  1.5.0     2022-12-02 [1] CRAN (R 4.3.0)\n##   SummarizedExperiment     1.30.2    2023-06-06 [1] Bioconductor\n##   tibble                   3.2.1     2023-03-20 [1] CRAN (R 4.3.0)\n##   tidyr                    1.3.0     2023-01-24 [1] CRAN (R 4.3.0)\n##   tidyselect               1.2.0     2022-10-10 [1] CRAN (R 4.3.0)\n##   tzdb                     0.4.0     2023-05-12 [1] CRAN (R 4.3.0)\n##   utf8                     1.2.3     2023-01-31 [1] CRAN (R 4.3.0)\n##   vctrs                    0.6.3     2023-06-14 [1] CRAN (R 4.3.0)\n##   viridisLite              0.4.2     2023-05-02 [1] CRAN (R 4.3.0)\n##   vroom                    1.6.3     2023-04-28 [1] CRAN (R 4.3.0)\n##   xfun                     0.39      2023-04-20 [1] CRAN (R 4.3.0)\n##   xtable                   1.8-4     2019-04-21 [1] CRAN (R 4.3.0)\n##   XVector                  0.40.0    2023-04-25 [1] Bioconductor\n##   yaml                     2.3.7     2023-01-23 [1] CRAN (R 4.3.0)\n##   zlibbioc                 1.46.0    2023-04-25 [1] Bioconductor\n##  \n##   [1] /home/rsg/R/x86_64-pc-linux-gnu-library/4.3\n##   [2] /usr/local/lib/R-4.3/lib/R/library\n##  \n##  ───────────────────────────────────────────────────────────────────────────"
  },
  {
    "objectID": "visualizing.html",
    "href": "visualizing.html",
    "title": "Visualizing Hi-C data in R",
    "section": "",
    "text": "Generating the example hic object 👇\n\n\n\n\n\nTo demonstrate how to visualize a HiCExperiment contact matrix, we will create an HiCExperiment object from an example .cool file provided in the HiContactsData package.\n\nlibrary(HiCExperiment)\nlibrary(HiContactsData)\n\n# ---- This downloads an example `.mcool` file and caches it locally \ncoolf &lt;- HiContactsData('yeast_wt', 'mcool')\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\n\n# ---- This creates a connection to the disk-stored `.mcool` file\ncf &lt;- CoolFile(coolf)\ncf\n##  CoolFile object\n##  .mcool file: /home/rsg/.cache/R/ExperimentHub/36d590c5583_7752 \n##  resolution: 1000 \n##  pairs file: \n##  metadata(0):\n\n# ---- This imports contacts from the chromosome `V` at resolution `2000`\nhic &lt;- import(cf, focus = 'V', resolution = 2000)\n\n\nhic\n##  `HiCExperiment` object with 303,545 contacts over 289 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"V\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 20177 \n##  scores(2): count balanced \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\n\n\n\n\n\n\n\nlibrary(HiContacts)\nplotMatrix(hic)\n\n\n\n\n\n\n\n\n\nhic2 &lt;- import(\n    CoolFile(HiContactsData('yeast_eco1', 'mcool')), \n    focus = 'V', \n    resolution = 2000\n)\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nplotMatrix(hic, compare.to = hic2)\n\n\n\n\n\n\n\n\n\nfull_hic &lt;- import(cf, resolution = 4000)\nhic_subset &lt;- full_hic[c(\"III\", \"IV\")]\nplotMatrix(hic_subset)\n\n\n\n\n\n\n\n\n\n\nplotMatrix(hic, use.scores = 'count')\n\n\n\n\n\n\n\n\n\nplotMatrix(hic, limits = c(-3.5, -1))\n\n\n\n\n\n\n\n\n\n# ----- `afmhotr` color map is shipped in the `HiContacts` package\nafmhotrColors() \n##  [1] \"#ffffff\" \"#f8f5c3\" \"#f4ee8d\" \"#f6be35\" \"#ee7d32\" \"#c44228\" \"#821d19\"\n##  [8] \"#381211\" \"#050606\"\nplotMatrix(\n    hic, \n    use.scores = 'balanced',\n    limits = c(-4, -1),\n    cmap = afmhotrColors()\n)\n\n\n\n\n\n\n\n\nRead the following sections from the OHCA book:\n\nHiCExperiment visualization\n\n\n##  ─ Session info ────────────────────────────────────────────────────────────\n##   setting  value\n##   version  R version 4.3.0 (2023-04-21)\n##   os       Ubuntu 18.04.6 LTS\n##   system   x86_64, linux-gnu\n##   ui       X11\n##   language (EN)\n##   collate  en_US.UTF-8\n##   ctype    en_US.UTF-8\n##   tz       Europe/Paris\n##   date     2023-07-28\n##   pandoc   2.13 @ /usr/bin/ (via rmarkdown)\n##  \n##  ─ Packages ────────────────────────────────────────────────────────────────\n##   package                * version   date (UTC) lib source\n##   abind                    1.4-5     2016-07-21 [1] CRAN (R 4.3.0)\n##   AnnotationDbi            1.62.2    2023-07-02 [1] Bioconductor\n##   AnnotationHub          * 3.8.0     2023-04-25 [1] Bioconductor\n##   beeswarm                 0.4.0     2021-06-01 [1] CRAN (R 4.3.0)\n##   Biobase                  2.60.0    2023-04-25 [1] Bioconductor\n##   BiocFileCache          * 2.8.0     2023-04-25 [1] Bioconductor\n##   BiocGenerics           * 0.46.0    2023-04-25 [1] Bioconductor\n##   BiocIO                   1.10.0    2023-04-25 [1] Bioconductor\n##   BiocManager              1.30.21.1 2023-07-18 [1] CRAN (R 4.3.0)\n##   BiocParallel             1.34.2    2023-05-22 [1] Bioconductor\n##   BiocVersion              3.17.1    2022-11-04 [1] Bioconductor\n##   Biostrings               2.68.1    2023-05-16 [1] Bioconductor\n##   bit                      4.0.5     2022-11-15 [1] CRAN (R 4.3.0)\n##   bit64                    4.0.5     2020-08-30 [1] CRAN (R 4.3.0)\n##   bitops                   1.0-7     2021-04-24 [1] CRAN (R 4.3.0)\n##   blob                     1.2.4     2023-03-17 [1] CRAN (R 4.3.0)\n##   cachem                   1.0.8     2023-05-01 [1] CRAN (R 4.3.0)\n##   cli                      3.6.1     2023-03-23 [1] CRAN (R 4.3.0)\n##   codetools                0.2-19    2023-02-01 [1] CRAN (R 4.3.0)\n##   colorspace               2.1-0     2023-01-23 [1] CRAN (R 4.3.0)\n##   crayon                   1.5.2     2022-09-29 [1] CRAN (R 4.3.0)\n##   curl                     5.0.1     2023-06-07 [1] CRAN (R 4.3.0)\n##   DBI                      1.1.3     2022-06-18 [1] CRAN (R 4.3.0)\n##   dbplyr                 * 2.3.3     2023-07-07 [1] CRAN (R 4.3.0)\n##   DelayedArray             0.26.6    2023-07-02 [1] Bioconductor\n##   digest                   0.6.33    2023-07-07 [1] CRAN (R 4.3.0)\n##   dplyr                    1.1.2     2023-04-20 [1] CRAN (R 4.3.0)\n##   ellipsis                 0.3.2     2021-04-29 [1] CRAN (R 4.3.0)\n##   evaluate                 0.21      2023-05-05 [1] CRAN (R 4.3.0)\n##   ExperimentHub          * 2.8.1     2023-07-12 [1] Bioconductor\n##   fansi                    1.0.4     2023-01-22 [1] CRAN (R 4.3.0)\n##   fastmap                  1.1.1     2023-02-24 [1] CRAN (R 4.3.0)\n##   filelock                 1.0.2     2018-10-05 [1] CRAN (R 4.3.0)\n##   generics                 0.1.3     2022-07-05 [1] CRAN (R 4.3.0)\n##   GenomeInfoDb             1.36.1    2023-06-21 [1] Bioconductor\n##   GenomeInfoDbData         1.2.10    2023-04-02 [1] Bioconductor\n##   GenomicRanges            1.52.0    2023-04-25 [1] Bioconductor\n##   ggbeeswarm               0.7.2     2023-04-29 [1] CRAN (R 4.3.0)\n##   ggplot2                  3.4.2     2023-04-03 [1] CRAN (R 4.3.0)\n##   ggrastr                  1.0.2     2023-06-01 [1] CRAN (R 4.3.0)\n##   glue                     1.6.2     2022-02-24 [1] CRAN (R 4.3.0)\n##   gtable                   0.3.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   HiCExperiment          * 1.1.1     2023-07-27 [1] Github (js2264/HiCExperiment@9e8f7bb)\n##   HiContacts             * 1.3.1     2023-07-27 [1] Github (js2264/HiContacts@d3bdfef)\n##   HiContactsData         * 1.3.0     2023-05-26 [1] Github (js2264/HiContactsData@adcb51f)\n##   hms                      1.1.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   htmltools                0.5.5     2023-03-23 [1] CRAN (R 4.3.0)\n##   htmlwidgets              1.6.2     2023-03-17 [1] CRAN (R 4.3.0)\n##   httpuv                   1.6.11    2023-05-11 [1] CRAN (R 4.3.0)\n##   httr                     1.4.6     2023-05-08 [1] CRAN (R 4.3.0)\n##   InteractionSet           1.29.1    2023-06-13 [1] Github (LTLA/InteractionSet@62cd50a)\n##   interactiveDisplayBase   1.38.0    2023-04-25 [1] Bioconductor\n##   IRanges                  2.34.1    2023-06-22 [1] Bioconductor\n##   jsonlite                 1.8.7     2023-06-29 [1] CRAN (R 4.3.0)\n##   KEGGREST                 1.40.0    2023-04-25 [1] Bioconductor\n##   knitr                    1.43      2023-05-25 [1] CRAN (R 4.3.0)\n##   later                    1.3.1     2023-05-02 [1] CRAN (R 4.3.0)\n##   lattice                  0.21-8    2023-04-05 [1] CRAN (R 4.3.0)\n##   lifecycle                1.0.3     2022-10-07 [1] CRAN (R 4.3.0)\n##   magrittr                 2.0.3     2022-03-30 [1] CRAN (R 4.3.0)\n##   Matrix                   1.6-0     2023-07-08 [1] CRAN (R 4.3.0)\n##   MatrixGenerics           1.12.2    2023-06-09 [1] Bioconductor\n##   matrixStats              1.0.0     2023-06-02 [1] CRAN (R 4.3.0)\n##   memoise                  2.0.1     2021-11-26 [1] CRAN (R 4.3.0)\n##   mime                     0.12      2021-09-28 [1] CRAN (R 4.3.0)\n##   munsell                  0.5.0     2018-06-12 [1] CRAN (R 4.3.0)\n##   pillar                   1.9.0     2023-03-22 [1] CRAN (R 4.3.0)\n##   pkgconfig                2.0.3     2019-09-22 [1] CRAN (R 4.3.0)\n##   png                      0.1-8     2022-11-29 [1] CRAN (R 4.3.0)\n##   promises                 1.2.0.1   2021-02-11 [1] CRAN (R 4.3.0)\n##   purrr                    1.0.1     2023-01-10 [1] CRAN (R 4.3.0)\n##   R6                       2.5.1     2021-08-19 [1] CRAN (R 4.3.0)\n##   rappdirs                 0.3.3     2021-01-31 [1] CRAN (R 4.3.0)\n##   Rcpp                     1.0.11    2023-07-06 [1] CRAN (R 4.3.0)\n##   RCurl                    1.98-1.12 2023-03-27 [1] CRAN (R 4.3.0)\n##   readr                    2.1.4     2023-02-10 [1] CRAN (R 4.3.0)\n##   rhdf5                    2.44.0    2023-04-25 [1] Bioconductor\n##   rhdf5filters             1.12.1    2023-04-30 [1] Bioconductor\n##   Rhdf5lib                 1.22.0    2023-04-25 [1] Bioconductor\n##   rlang                    1.1.1     2023-04-28 [1] CRAN (R 4.3.0)\n##   rmarkdown                2.23      2023-07-01 [1] CRAN (R 4.3.0)\n##   RSpectra                 0.16-1    2022-04-24 [1] CRAN (R 4.3.0)\n##   RSQLite                  2.3.1     2023-04-03 [1] CRAN (R 4.3.0)\n##   rstudioapi               0.15.0    2023-07-07 [1] CRAN (R 4.3.0)\n##   S4Arrays                 1.0.5     2023-07-24 [1] Bioconductor\n##   S4Vectors                0.38.1    2023-05-02 [1] Bioconductor\n##   scales                   1.2.1     2022-08-20 [1] CRAN (R 4.3.0)\n##   sessioninfo              1.2.2     2021-12-06 [1] CRAN (R 4.3.0)\n##   shiny                    1.7.4.1   2023-07-06 [1] CRAN (R 4.3.0)\n##   strawr                   0.0.91    2023-03-29 [1] CRAN (R 4.3.0)\n##   stringi                  1.7.12    2023-01-11 [1] CRAN (R 4.3.0)\n##   stringr                  1.5.0     2022-12-02 [1] CRAN (R 4.3.0)\n##   SummarizedExperiment     1.30.2    2023-06-06 [1] Bioconductor\n##   tibble                   3.2.1     2023-03-20 [1] CRAN (R 4.3.0)\n##   tidyr                    1.3.0     2023-01-24 [1] CRAN (R 4.3.0)\n##   tidyselect               1.2.0     2022-10-10 [1] CRAN (R 4.3.0)\n##   tzdb                     0.4.0     2023-05-12 [1] CRAN (R 4.3.0)\n##   utf8                     1.2.3     2023-01-31 [1] CRAN (R 4.3.0)\n##   vctrs                    0.6.3     2023-06-14 [1] CRAN (R 4.3.0)\n##   vipor                    0.4.5     2017-03-22 [1] CRAN (R 4.3.0)\n##   vroom                    1.6.3     2023-04-28 [1] CRAN (R 4.3.0)\n##   xfun                     0.39      2023-04-20 [1] CRAN (R 4.3.0)\n##   xtable                   1.8-4     2019-04-21 [1] CRAN (R 4.3.0)\n##   XVector                  0.40.0    2023-04-25 [1] Bioconductor\n##   yaml                     2.3.7     2023-01-23 [1] CRAN (R 4.3.0)\n##   zlibbioc                 1.46.0    2023-04-25 [1] Bioconductor\n##  \n##   [1] /home/rsg/R/x86_64-pc-linux-gnu-library/4.3\n##   [2] /usr/local/lib/R-4.3/lib/R/library\n##  \n##  ───────────────────────────────────────────────────────────────────────────"
  },
  {
    "objectID": "visualizing.html#visualizing-hi-c-contact-maps",
    "href": "visualizing.html#visualizing-hi-c-contact-maps",
    "title": "Visualizing Hi-C data in R",
    "section": "",
    "text": "library(HiContacts)\nplotMatrix(hic)\n\n\n\n\n\n\n\n\n\nhic2 &lt;- import(\n    CoolFile(HiContactsData('yeast_eco1', 'mcool')), \n    focus = 'V', \n    resolution = 2000\n)\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nplotMatrix(hic, compare.to = hic2)\n\n\n\n\n\n\n\n\n\nfull_hic &lt;- import(cf, resolution = 4000)\nhic_subset &lt;- full_hic[c(\"III\", \"IV\")]\nplotMatrix(hic_subset)"
  },
  {
    "objectID": "visualizing.html#tuning-hi-c-contact-maps",
    "href": "visualizing.html#tuning-hi-c-contact-maps",
    "title": "Visualizing Hi-C data in R",
    "section": "",
    "text": "plotMatrix(hic, use.scores = 'count')\n\n\n\n\n\n\n\n\n\nplotMatrix(hic, limits = c(-3.5, -1))\n\n\n\n\n\n\n\n\n\n# ----- `afmhotr` color map is shipped in the `HiContacts` package\nafmhotrColors() \n##  [1] \"#ffffff\" \"#f8f5c3\" \"#f4ee8d\" \"#f6be35\" \"#ee7d32\" \"#c44228\" \"#821d19\"\n##  [8] \"#381211\" \"#050606\"\nplotMatrix(\n    hic, \n    use.scores = 'balanced',\n    limits = c(-4, -1),\n    cmap = afmhotrColors()\n)"
  },
  {
    "objectID": "visualizing.html#read-more",
    "href": "visualizing.html#read-more",
    "title": "Visualizing Hi-C data in R",
    "section": "",
    "text": "Read the following sections from the OHCA book:\n\nHiCExperiment visualization"
  },
  {
    "objectID": "visualizing.html#session-info",
    "href": "visualizing.html#session-info",
    "title": "Visualizing Hi-C data in R",
    "section": "",
    "text": "##  ─ Session info ────────────────────────────────────────────────────────────\n##   setting  value\n##   version  R version 4.3.0 (2023-04-21)\n##   os       Ubuntu 18.04.6 LTS\n##   system   x86_64, linux-gnu\n##   ui       X11\n##   language (EN)\n##   collate  en_US.UTF-8\n##   ctype    en_US.UTF-8\n##   tz       Europe/Paris\n##   date     2023-07-28\n##   pandoc   2.13 @ /usr/bin/ (via rmarkdown)\n##  \n##  ─ Packages ────────────────────────────────────────────────────────────────\n##   package                * version   date (UTC) lib source\n##   abind                    1.4-5     2016-07-21 [1] CRAN (R 4.3.0)\n##   AnnotationDbi            1.62.2    2023-07-02 [1] Bioconductor\n##   AnnotationHub          * 3.8.0     2023-04-25 [1] Bioconductor\n##   beeswarm                 0.4.0     2021-06-01 [1] CRAN (R 4.3.0)\n##   Biobase                  2.60.0    2023-04-25 [1] Bioconductor\n##   BiocFileCache          * 2.8.0     2023-04-25 [1] Bioconductor\n##   BiocGenerics           * 0.46.0    2023-04-25 [1] Bioconductor\n##   BiocIO                   1.10.0    2023-04-25 [1] Bioconductor\n##   BiocManager              1.30.21.1 2023-07-18 [1] CRAN (R 4.3.0)\n##   BiocParallel             1.34.2    2023-05-22 [1] Bioconductor\n##   BiocVersion              3.17.1    2022-11-04 [1] Bioconductor\n##   Biostrings               2.68.1    2023-05-16 [1] Bioconductor\n##   bit                      4.0.5     2022-11-15 [1] CRAN (R 4.3.0)\n##   bit64                    4.0.5     2020-08-30 [1] CRAN (R 4.3.0)\n##   bitops                   1.0-7     2021-04-24 [1] CRAN (R 4.3.0)\n##   blob                     1.2.4     2023-03-17 [1] CRAN (R 4.3.0)\n##   cachem                   1.0.8     2023-05-01 [1] CRAN (R 4.3.0)\n##   cli                      3.6.1     2023-03-23 [1] CRAN (R 4.3.0)\n##   codetools                0.2-19    2023-02-01 [1] CRAN (R 4.3.0)\n##   colorspace               2.1-0     2023-01-23 [1] CRAN (R 4.3.0)\n##   crayon                   1.5.2     2022-09-29 [1] CRAN (R 4.3.0)\n##   curl                     5.0.1     2023-06-07 [1] CRAN (R 4.3.0)\n##   DBI                      1.1.3     2022-06-18 [1] CRAN (R 4.3.0)\n##   dbplyr                 * 2.3.3     2023-07-07 [1] CRAN (R 4.3.0)\n##   DelayedArray             0.26.6    2023-07-02 [1] Bioconductor\n##   digest                   0.6.33    2023-07-07 [1] CRAN (R 4.3.0)\n##   dplyr                    1.1.2     2023-04-20 [1] CRAN (R 4.3.0)\n##   ellipsis                 0.3.2     2021-04-29 [1] CRAN (R 4.3.0)\n##   evaluate                 0.21      2023-05-05 [1] CRAN (R 4.3.0)\n##   ExperimentHub          * 2.8.1     2023-07-12 [1] Bioconductor\n##   fansi                    1.0.4     2023-01-22 [1] CRAN (R 4.3.0)\n##   fastmap                  1.1.1     2023-02-24 [1] CRAN (R 4.3.0)\n##   filelock                 1.0.2     2018-10-05 [1] CRAN (R 4.3.0)\n##   generics                 0.1.3     2022-07-05 [1] CRAN (R 4.3.0)\n##   GenomeInfoDb             1.36.1    2023-06-21 [1] Bioconductor\n##   GenomeInfoDbData         1.2.10    2023-04-02 [1] Bioconductor\n##   GenomicRanges            1.52.0    2023-04-25 [1] Bioconductor\n##   ggbeeswarm               0.7.2     2023-04-29 [1] CRAN (R 4.3.0)\n##   ggplot2                  3.4.2     2023-04-03 [1] CRAN (R 4.3.0)\n##   ggrastr                  1.0.2     2023-06-01 [1] CRAN (R 4.3.0)\n##   glue                     1.6.2     2022-02-24 [1] CRAN (R 4.3.0)\n##   gtable                   0.3.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   HiCExperiment          * 1.1.1     2023-07-27 [1] Github (js2264/HiCExperiment@9e8f7bb)\n##   HiContacts             * 1.3.1     2023-07-27 [1] Github (js2264/HiContacts@d3bdfef)\n##   HiContactsData         * 1.3.0     2023-05-26 [1] Github (js2264/HiContactsData@adcb51f)\n##   hms                      1.1.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   htmltools                0.5.5     2023-03-23 [1] CRAN (R 4.3.0)\n##   htmlwidgets              1.6.2     2023-03-17 [1] CRAN (R 4.3.0)\n##   httpuv                   1.6.11    2023-05-11 [1] CRAN (R 4.3.0)\n##   httr                     1.4.6     2023-05-08 [1] CRAN (R 4.3.0)\n##   InteractionSet           1.29.1    2023-06-13 [1] Github (LTLA/InteractionSet@62cd50a)\n##   interactiveDisplayBase   1.38.0    2023-04-25 [1] Bioconductor\n##   IRanges                  2.34.1    2023-06-22 [1] Bioconductor\n##   jsonlite                 1.8.7     2023-06-29 [1] CRAN (R 4.3.0)\n##   KEGGREST                 1.40.0    2023-04-25 [1] Bioconductor\n##   knitr                    1.43      2023-05-25 [1] CRAN (R 4.3.0)\n##   later                    1.3.1     2023-05-02 [1] CRAN (R 4.3.0)\n##   lattice                  0.21-8    2023-04-05 [1] CRAN (R 4.3.0)\n##   lifecycle                1.0.3     2022-10-07 [1] CRAN (R 4.3.0)\n##   magrittr                 2.0.3     2022-03-30 [1] CRAN (R 4.3.0)\n##   Matrix                   1.6-0     2023-07-08 [1] CRAN (R 4.3.0)\n##   MatrixGenerics           1.12.2    2023-06-09 [1] Bioconductor\n##   matrixStats              1.0.0     2023-06-02 [1] CRAN (R 4.3.0)\n##   memoise                  2.0.1     2021-11-26 [1] CRAN (R 4.3.0)\n##   mime                     0.12      2021-09-28 [1] CRAN (R 4.3.0)\n##   munsell                  0.5.0     2018-06-12 [1] CRAN (R 4.3.0)\n##   pillar                   1.9.0     2023-03-22 [1] CRAN (R 4.3.0)\n##   pkgconfig                2.0.3     2019-09-22 [1] CRAN (R 4.3.0)\n##   png                      0.1-8     2022-11-29 [1] CRAN (R 4.3.0)\n##   promises                 1.2.0.1   2021-02-11 [1] CRAN (R 4.3.0)\n##   purrr                    1.0.1     2023-01-10 [1] CRAN (R 4.3.0)\n##   R6                       2.5.1     2021-08-19 [1] CRAN (R 4.3.0)\n##   rappdirs                 0.3.3     2021-01-31 [1] CRAN (R 4.3.0)\n##   Rcpp                     1.0.11    2023-07-06 [1] CRAN (R 4.3.0)\n##   RCurl                    1.98-1.12 2023-03-27 [1] CRAN (R 4.3.0)\n##   readr                    2.1.4     2023-02-10 [1] CRAN (R 4.3.0)\n##   rhdf5                    2.44.0    2023-04-25 [1] Bioconductor\n##   rhdf5filters             1.12.1    2023-04-30 [1] Bioconductor\n##   Rhdf5lib                 1.22.0    2023-04-25 [1] Bioconductor\n##   rlang                    1.1.1     2023-04-28 [1] CRAN (R 4.3.0)\n##   rmarkdown                2.23      2023-07-01 [1] CRAN (R 4.3.0)\n##   RSpectra                 0.16-1    2022-04-24 [1] CRAN (R 4.3.0)\n##   RSQLite                  2.3.1     2023-04-03 [1] CRAN (R 4.3.0)\n##   rstudioapi               0.15.0    2023-07-07 [1] CRAN (R 4.3.0)\n##   S4Arrays                 1.0.5     2023-07-24 [1] Bioconductor\n##   S4Vectors                0.38.1    2023-05-02 [1] Bioconductor\n##   scales                   1.2.1     2022-08-20 [1] CRAN (R 4.3.0)\n##   sessioninfo              1.2.2     2021-12-06 [1] CRAN (R 4.3.0)\n##   shiny                    1.7.4.1   2023-07-06 [1] CRAN (R 4.3.0)\n##   strawr                   0.0.91    2023-03-29 [1] CRAN (R 4.3.0)\n##   stringi                  1.7.12    2023-01-11 [1] CRAN (R 4.3.0)\n##   stringr                  1.5.0     2022-12-02 [1] CRAN (R 4.3.0)\n##   SummarizedExperiment     1.30.2    2023-06-06 [1] Bioconductor\n##   tibble                   3.2.1     2023-03-20 [1] CRAN (R 4.3.0)\n##   tidyr                    1.3.0     2023-01-24 [1] CRAN (R 4.3.0)\n##   tidyselect               1.2.0     2022-10-10 [1] CRAN (R 4.3.0)\n##   tzdb                     0.4.0     2023-05-12 [1] CRAN (R 4.3.0)\n##   utf8                     1.2.3     2023-01-31 [1] CRAN (R 4.3.0)\n##   vctrs                    0.6.3     2023-06-14 [1] CRAN (R 4.3.0)\n##   vipor                    0.4.5     2017-03-22 [1] CRAN (R 4.3.0)\n##   vroom                    1.6.3     2023-04-28 [1] CRAN (R 4.3.0)\n##   xfun                     0.39      2023-04-20 [1] CRAN (R 4.3.0)\n##   xtable                   1.8-4     2019-04-21 [1] CRAN (R 4.3.0)\n##   XVector                  0.40.0    2023-04-25 [1] Bioconductor\n##   yaml                     2.3.7     2023-01-23 [1] CRAN (R 4.3.0)\n##   zlibbioc                 1.46.0    2023-04-25 [1] Bioconductor\n##  \n##   [1] /home/rsg/R/x86_64-pc-linux-gnu-library/4.3\n##   [2] /usr/local/lib/R-4.3/lib/R/library\n##  \n##  ───────────────────────────────────────────────────────────────────────────"
  },
  {
    "objectID": "investigating.html",
    "href": "investigating.html",
    "title": "Investigating Hi-C data in R",
    "section": "",
    "text": "library(HiContactsData)\nlibrary(HiCExperiment)\nlibrary(HiContacts)\nhicpro_matrix &lt;- HiContactsData('yeast_wt', format = 'hicpro_matrix')\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nhicpro_regions &lt;- HiContactsData('yeast_wt', format = 'hicpro_bed')\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nhicprof &lt;- HicproFile(hicpro_matrix, bed = hicpro_regions)\nhicpro &lt;- import(hicprof)[\"II\"]\nhicpro\n##  `HiCExperiment` object with 523,301 contacts over 802 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/29210052806_7837\" \n##  focus: \"II\" \n##  resolutions(1): 1000\n##  active resolution: 1000 \n##  interactions: 70437 \n##  scores(1): count \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(1): regions\nhicpro &lt;- normalize(hicpro)\ncowplot::plot_grid(\n    plotMatrix(hicpro, use.scores = 'count'), \n    plotMatrix(hicpro, use.scores = 'ICE')\n)\n\n\n\n\n\n\n\n\n\nhic &lt;- import(\n    CoolFile(HiContactsData('yeast_wt', 'mcool')), \n    focus = 'II', \n    resolution = 2000\n)\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nhic_eco1 &lt;- import(\n    CoolFile(HiContactsData('yeast_eco1', 'mcool')), \n    focus = 'II', \n    resolution = 2000\n)\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\ndiv_contacts &lt;- divide(hic_eco1, by = hic) \n\ncowplot::plot_grid(\n    plotMatrix(hic_eco1, compare.to = hic, limits = c(-4, -1)), \n    plotMatrix(\n        div_contacts, \n        use.scores = 'balanced.fc', \n        scale = 'log2', \n        limits = c(-1, 1),\n        cmap = bwrColors()\n    )\n)\n\n\n\n\n\n\n\n\n\ndetrended_hic &lt;- detrend(hic)\ndetrended_hic\n##  `HiCExperiment` object with 471,364 contacts over 407 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"II\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 34063 \n##  scores(4): count balanced expected detrended \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\ncowplot::plot_grid(\n    plotMatrix(detrended_hic, use.scores = 'balanced', scale = 'log10', limits = c(-3.5, -1.2), caption = FALSE),\n    plotMatrix(detrended_hic, use.scores = 'expected', scale = 'log10', limits = c(-3.5, -1.2), caption = FALSE),\n    plotMatrix(detrended_hic, use.scores = 'detrended', scale = 'linear', limits = c(-1, 1), cmap = bwrColors(), caption = FALSE), \n    nrow = 1\n)\n\n\n\n\n\n\n\n\n\nautocorr_hic &lt;- autocorrelate(hic)\n##  \nautocorr_hic\n##  `HiCExperiment` object with 471,364 contacts over 407 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"II\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 34063 \n##  scores(5): count balanced expected detrended autocorrelated \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\ncowplot::plot_grid(\n    plotMatrix(autocorr_hic, use.scores = 'balanced', scale = 'log10', limits = c(-3.5, -1.2), caption = FALSE),\n    plotMatrix(autocorr_hic, use.scores = 'autocorrelated', scale = 'linear', limits = c(-0.4, 0.4), cmap = bwrColors(), caption = FALSE), \n    nrow = 1\n)\n\n\n\n\n\n\n\n\n\n\npairsf &lt;- HiContactsData('yeast_wt', 'pairs.gz')\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\npairsFile(hic) &lt;- pairsf\neco1_pairsf &lt;- HiContactsData('yeast_eco1', 'pairs.gz')\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nhic_eco1 &lt;- PairsFile(eco1_pairsf)\n\n\nps &lt;- distanceLaw(hic, by_chr = TRUE) \n##  Importing pairs file /home/rsg/.cache/R/ExperimentHub/24a464c5ca2_7753 in memory. This may take a while...\nps_eco1 &lt;- distanceLaw(hic_eco1, by_chr = TRUE) \n##  Importing pairs file /home/rsg/.cache/R/ExperimentHub/6df72d47b9d_7755 in memory. This may take a while...\nps\n##  # A tibble: 115 × 6\n##    chr   binned_distance          p     norm_p norm_p_unity slope\n##    &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;\n##  1 II                 14 0.00000212 0.00000106         2.27  0   \n##  2 II                 16 0.0000170  0.0000170         36.4   1.56\n##  3 II                 17 0.0000361  0.0000180         38.6   1.55\n##  4 II                 19 0.0000424  0.0000212         45.5   1.55\n##  5 II                 21 0.0000467  0.0000233         50.0   1.54\n##  6 II                 23 0.0000870  0.0000290         62.1   1.53\n##  # ℹ 109 more rows\nps_eco1\n##  # A tibble: 115 × 6\n##    chr   binned_distance          p     norm_p norm_p_unity slope\n##    &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;\n##  1 II                 14 0.00000201 0.00000100        0.660  0   \n##  2 II                 16 0.0000221  0.0000221        14.5    1.46\n##  3 II                 17 0.0000492  0.0000246        16.2    1.46\n##  4 II                 19 0.0000412  0.0000206        13.5    1.45\n##  5 II                 21 0.0000653  0.0000326        21.5    1.45\n##  6 II                 23 0.0000803  0.0000268        17.6    1.44\n##  # ℹ 109 more rows\nlibrary(dplyr)\n##  \n##  Attaching package: 'dplyr'\n##  The following objects are masked from 'package:dbplyr':\n##  \n##      ident, sql\n##  The following objects are masked from 'package:BiocGenerics':\n##  \n##      combine, intersect, setdiff, union\n##  The following objects are masked from 'package:stats':\n##  \n##      filter, lag\n##  The following objects are masked from 'package:base':\n##  \n##      intersect, setdiff, setequal, union\nmerged_ps &lt;- rbind(\n    mutate(ps, sample = 'WT'), \n    mutate(ps_eco1, sample = 'eco1')\n)\nlibrary(ggplot2)\n##  \n##  Attaching package: 'ggplot2'\n##  The following object is masked from 'package:HiCExperiment':\n##  \n##      resolution\nplotPs(merged_ps, aes(x = binned_distance, y = norm_p, color = sample)) + \n    scale_color_manual(values = c('#c6c6c6', '#ca0000'))\n##  Warning: Removed 134 rows containing missing values (`geom_line()`).\n\n\n\n\n\n\nplotPsSlope(merged_ps, aes(x = binned_distance, y = slope, color = sample)) + \n    scale_color_manual(values = c('#c6c6c6', '#ca0000'))\n##  Warning: Removed 135 rows containing missing values (`geom_line()`).\n\n\n\n\n\n\n\n\n\nfull_hic &lt;- import(\n    CoolFile(HiContactsData('yeast_wt', 'mcool')), \n    resolution = 2000\n)\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\ncis_trans &lt;- cisTransRatio(full_hic) \ncis_trans\n##  # A tibble: 16 × 6\n##  # Groups:   chr [16]\n##    chr       cis  trans n_total cis_pct trans_pct\n##    &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;\n##  1 I      186326  96738  283064   0.658     0.342\n##  2 II     942728 273966 1216694   0.775     0.225\n##  3 III    303980 127087  431067   0.705     0.295\n##  4 IV    1858062 418218 2276280   0.816     0.184\n##  5 V      607090 220873  827963   0.733     0.267\n##  6 VI     280282 127771  408053   0.687     0.313\n##  # ℹ 10 more rows\n\n\n\nlibrary(GenomicRanges)\n##  Loading required package: stats4\n##  Loading required package: S4Vectors\n##  \n##  Attaching package: 'S4Vectors'\n##  The following objects are masked from 'package:dplyr':\n##  \n##      first, rename\n##  The following object is masked from 'package:HiCExperiment':\n##  \n##      metadata&lt;-\n##  The following object is masked from 'package:utils':\n##  \n##      findMatches\n##  The following objects are masked from 'package:base':\n##  \n##      expand.grid, I, unname\n##  Loading required package: IRanges\n##  \n##  Attaching package: 'IRanges'\n##  The following objects are masked from 'package:dplyr':\n##  \n##      collapse, desc, slice\n##  Loading required package: GenomeInfoDb\nv4C &lt;- virtual4C(full_hic, viewpoint = GRanges(\"II:230001-240000\"))\nv4C\n##  GRanges object with 6045 ranges and 4 metadata columns:\n##           seqnames        ranges strand |       score        viewpoint\n##              &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;numeric&gt;      &lt;character&gt;\n##       [1]        I        1-2000      * |  0.00000000 II:230001-240000\n##       [2]        I     2001-4000      * |  0.00000000 II:230001-240000\n##       [3]        I     4001-6000      * |  0.00129049 II:230001-240000\n##       [4]        I     6001-8000      * |  0.00000000 II:230001-240000\n##       [5]        I    8001-10000      * |  0.00000000 II:230001-240000\n##       ...      ...           ...    ... .         ...              ...\n##    [6041]      XVI 940001-942000      * | 0.000775721 II:230001-240000\n##    [6042]      XVI 942001-944000      * | 0.000000000 II:230001-240000\n##    [6043]      XVI 944001-946000      * | 0.000000000 II:230001-240000\n##    [6044]      XVI 946001-948000      * | 0.000000000 II:230001-240000\n##    [6045]      XVI 948001-948066      * | 0.000000000 II:230001-240000\n##              center in_viewpoint\n##           &lt;numeric&gt;    &lt;logical&gt;\n##       [1]    1000.5        FALSE\n##       [2]    3000.5        FALSE\n##       [3]    5000.5        FALSE\n##       [4]    7000.5        FALSE\n##       [5]    9000.5        FALSE\n##       ...       ...          ...\n##    [6041]    941000        FALSE\n##    [6042]    943000        FALSE\n##    [6043]    945000        FALSE\n##    [6044]    947000        FALSE\n##    [6045]    948034        FALSE\n##    -------\n##    seqinfo: 16 sequences from an unspecified genome; no seqlengths\nas_tibble(v4C) |&gt; \n    filter(seqnames == \"III\") |&gt; \n    ggplot(aes(x = center, y = score)) + \n    geom_line() + \n    labs(x = \"chr. III\", y = \"Contacts with viewpoint @ II:230001-240000\") +\n    scale_x_continuous(labels = scales::unit_format(unit = \"M\", scale = 1e-06))\n\n\n\n\n\n\n\n\nRead the following sections from the OHCA book:\n\nMatrix-centric analyses in Hi-C\nInteraction-centric analyses in Hi-C\n\n\n##  ─ Session info ────────────────────────────────────────────────────────────\n##   setting  value\n##   version  R version 4.3.0 (2023-04-21)\n##   os       Ubuntu 18.04.6 LTS\n##   system   x86_64, linux-gnu\n##   ui       X11\n##   language (EN)\n##   collate  en_US.UTF-8\n##   ctype    en_US.UTF-8\n##   tz       Europe/Paris\n##   date     2023-07-28\n##   pandoc   2.13 @ /usr/bin/ (via rmarkdown)\n##  \n##  ─ Packages ────────────────────────────────────────────────────────────────\n##   package                * version   date (UTC) lib source\n##   abind                    1.4-5     2016-07-21 [1] CRAN (R 4.3.0)\n##   AnnotationDbi            1.62.2    2023-07-02 [1] Bioconductor\n##   AnnotationHub          * 3.8.0     2023-04-25 [1] Bioconductor\n##   beeswarm                 0.4.0     2021-06-01 [1] CRAN (R 4.3.0)\n##   Biobase                  2.60.0    2023-04-25 [1] Bioconductor\n##   BiocFileCache          * 2.8.0     2023-04-25 [1] Bioconductor\n##   BiocGenerics           * 0.46.0    2023-04-25 [1] Bioconductor\n##   BiocIO                   1.10.0    2023-04-25 [1] Bioconductor\n##   BiocManager              1.30.21.1 2023-07-18 [1] CRAN (R 4.3.0)\n##   BiocParallel             1.34.2    2023-05-22 [1] Bioconductor\n##   BiocVersion              3.17.1    2022-11-04 [1] Bioconductor\n##   Biostrings               2.68.1    2023-05-16 [1] Bioconductor\n##   bit                      4.0.5     2022-11-15 [1] CRAN (R 4.3.0)\n##   bit64                    4.0.5     2020-08-30 [1] CRAN (R 4.3.0)\n##   bitops                   1.0-7     2021-04-24 [1] CRAN (R 4.3.0)\n##   blob                     1.2.4     2023-03-17 [1] CRAN (R 4.3.0)\n##   cachem                   1.0.8     2023-05-01 [1] CRAN (R 4.3.0)\n##   cli                      3.6.1     2023-03-23 [1] CRAN (R 4.3.0)\n##   codetools                0.2-19    2023-02-01 [1] CRAN (R 4.3.0)\n##   colorspace               2.1-0     2023-01-23 [1] CRAN (R 4.3.0)\n##   crayon                   1.5.2     2022-09-29 [1] CRAN (R 4.3.0)\n##   curl                     5.0.1     2023-06-07 [1] CRAN (R 4.3.0)\n##   DBI                      1.1.3     2022-06-18 [1] CRAN (R 4.3.0)\n##   dbplyr                 * 2.3.3     2023-07-07 [1] CRAN (R 4.3.0)\n##   DelayedArray             0.26.6    2023-07-02 [1] Bioconductor\n##   digest                   0.6.33    2023-07-07 [1] CRAN (R 4.3.0)\n##   dplyr                  * 1.1.2     2023-04-20 [1] CRAN (R 4.3.0)\n##   ellipsis                 0.3.2     2021-04-29 [1] CRAN (R 4.3.0)\n##   evaluate                 0.21      2023-05-05 [1] CRAN (R 4.3.0)\n##   ExperimentHub          * 2.8.1     2023-07-12 [1] Bioconductor\n##   fansi                    1.0.4     2023-01-22 [1] CRAN (R 4.3.0)\n##   farver                   2.1.1     2022-07-06 [1] CRAN (R 4.3.0)\n##   fastmap                  1.1.1     2023-02-24 [1] CRAN (R 4.3.0)\n##   filelock                 1.0.2     2018-10-05 [1] CRAN (R 4.3.0)\n##   generics                 0.1.3     2022-07-05 [1] CRAN (R 4.3.0)\n##   GenomeInfoDb           * 1.36.1    2023-06-21 [1] Bioconductor\n##   GenomeInfoDbData         1.2.10    2023-04-02 [1] Bioconductor\n##   GenomicRanges          * 1.52.0    2023-04-25 [1] Bioconductor\n##   ggbeeswarm               0.7.2     2023-04-29 [1] CRAN (R 4.3.0)\n##   ggplot2                * 3.4.2     2023-04-03 [1] CRAN (R 4.3.0)\n##   ggrastr                  1.0.2     2023-06-01 [1] CRAN (R 4.3.0)\n##   glue                     1.6.2     2022-02-24 [1] CRAN (R 4.3.0)\n##   gtable                   0.3.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   HiCExperiment          * 1.1.1     2023-07-27 [1] Github (js2264/HiCExperiment@9e8f7bb)\n##   HiContacts             * 1.3.1     2023-07-27 [1] Github (js2264/HiContacts@d3bdfef)\n##   HiContactsData         * 1.3.0     2023-05-26 [1] Github (js2264/HiContactsData@adcb51f)\n##   hms                      1.1.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   htmltools                0.5.5     2023-03-23 [1] CRAN (R 4.3.0)\n##   htmlwidgets              1.6.2     2023-03-17 [1] CRAN (R 4.3.0)\n##   httpuv                   1.6.11    2023-05-11 [1] CRAN (R 4.3.0)\n##   httr                     1.4.6     2023-05-08 [1] CRAN (R 4.3.0)\n##   InteractionSet           1.29.1    2023-06-13 [1] Github (LTLA/InteractionSet@62cd50a)\n##   interactiveDisplayBase   1.38.0    2023-04-25 [1] Bioconductor\n##   IRanges                * 2.34.1    2023-06-22 [1] Bioconductor\n##   jsonlite                 1.8.7     2023-06-29 [1] CRAN (R 4.3.0)\n##   KEGGREST                 1.40.0    2023-04-25 [1] Bioconductor\n##   knitr                    1.43      2023-05-25 [1] CRAN (R 4.3.0)\n##   labeling                 0.4.2     2020-10-20 [1] CRAN (R 4.3.0)\n##   later                    1.3.1     2023-05-02 [1] CRAN (R 4.3.0)\n##   lattice                  0.21-8    2023-04-05 [1] CRAN (R 4.3.0)\n##   lifecycle                1.0.3     2022-10-07 [1] CRAN (R 4.3.0)\n##   magrittr                 2.0.3     2022-03-30 [1] CRAN (R 4.3.0)\n##   Matrix                   1.6-0     2023-07-08 [1] CRAN (R 4.3.0)\n##   MatrixGenerics           1.12.2    2023-06-09 [1] Bioconductor\n##   matrixStats              1.0.0     2023-06-02 [1] CRAN (R 4.3.0)\n##   memoise                  2.0.1     2021-11-26 [1] CRAN (R 4.3.0)\n##   mime                     0.12      2021-09-28 [1] CRAN (R 4.3.0)\n##   munsell                  0.5.0     2018-06-12 [1] CRAN (R 4.3.0)\n##   pillar                   1.9.0     2023-03-22 [1] CRAN (R 4.3.0)\n##   pkgconfig                2.0.3     2019-09-22 [1] CRAN (R 4.3.0)\n##   png                      0.1-8     2022-11-29 [1] CRAN (R 4.3.0)\n##   promises                 1.2.0.1   2021-02-11 [1] CRAN (R 4.3.0)\n##   purrr                    1.0.1     2023-01-10 [1] CRAN (R 4.3.0)\n##   R6                       2.5.1     2021-08-19 [1] CRAN (R 4.3.0)\n##   rappdirs                 0.3.3     2021-01-31 [1] CRAN (R 4.3.0)\n##   Rcpp                     1.0.11    2023-07-06 [1] CRAN (R 4.3.0)\n##   RCurl                    1.98-1.12 2023-03-27 [1] CRAN (R 4.3.0)\n##   readr                    2.1.4     2023-02-10 [1] CRAN (R 4.3.0)\n##   rhdf5                    2.44.0    2023-04-25 [1] Bioconductor\n##   rhdf5filters             1.12.1    2023-04-30 [1] Bioconductor\n##   Rhdf5lib                 1.22.0    2023-04-25 [1] Bioconductor\n##   rlang                    1.1.1     2023-04-28 [1] CRAN (R 4.3.0)\n##   rmarkdown                2.23      2023-07-01 [1] CRAN (R 4.3.0)\n##   RSpectra                 0.16-1    2022-04-24 [1] CRAN (R 4.3.0)\n##   RSQLite                  2.3.1     2023-04-03 [1] CRAN (R 4.3.0)\n##   rstudioapi               0.15.0    2023-07-07 [1] CRAN (R 4.3.0)\n##   S4Arrays                 1.0.5     2023-07-24 [1] Bioconductor\n##   S4Vectors              * 0.38.1    2023-05-02 [1] Bioconductor\n##   scales                   1.2.1     2022-08-20 [1] CRAN (R 4.3.0)\n##   sessioninfo              1.2.2     2021-12-06 [1] CRAN (R 4.3.0)\n##   shiny                    1.7.4.1   2023-07-06 [1] CRAN (R 4.3.0)\n##   strawr                   0.0.91    2023-03-29 [1] CRAN (R 4.3.0)\n##   stringi                  1.7.12    2023-01-11 [1] CRAN (R 4.3.0)\n##   stringr                  1.5.0     2022-12-02 [1] CRAN (R 4.3.0)\n##   SummarizedExperiment     1.30.2    2023-06-06 [1] Bioconductor\n##   tibble                   3.2.1     2023-03-20 [1] CRAN (R 4.3.0)\n##   tidyr                    1.3.0     2023-01-24 [1] CRAN (R 4.3.0)\n##   tidyselect               1.2.0     2022-10-10 [1] CRAN (R 4.3.0)\n##   tzdb                     0.4.0     2023-05-12 [1] CRAN (R 4.3.0)\n##   utf8                     1.2.3     2023-01-31 [1] CRAN (R 4.3.0)\n##   vctrs                    0.6.3     2023-06-14 [1] CRAN (R 4.3.0)\n##   vipor                    0.4.5     2017-03-22 [1] CRAN (R 4.3.0)\n##   vroom                    1.6.3     2023-04-28 [1] CRAN (R 4.3.0)\n##   withr                    2.5.0     2022-03-03 [1] CRAN (R 4.3.0)\n##   xfun                     0.39      2023-04-20 [1] CRAN (R 4.3.0)\n##   xtable                   1.8-4     2019-04-21 [1] CRAN (R 4.3.0)\n##   XVector                  0.40.0    2023-04-25 [1] Bioconductor\n##   yaml                     2.3.7     2023-01-23 [1] CRAN (R 4.3.0)\n##   zlibbioc                 1.46.0    2023-04-25 [1] Bioconductor\n##  \n##   [1] /home/rsg/R/x86_64-pc-linux-gnu-library/4.3\n##   [2] /usr/local/lib/R-4.3/lib/R/library\n##  \n##  ───────────────────────────────────────────────────────────────────────────"
  },
  {
    "objectID": "investigating.html#hi-c-arithmetic",
    "href": "investigating.html#hi-c-arithmetic",
    "title": "Investigating Hi-C data in R",
    "section": "",
    "text": "library(HiContactsData)\nlibrary(HiCExperiment)\nlibrary(HiContacts)\nhicpro_matrix &lt;- HiContactsData('yeast_wt', format = 'hicpro_matrix')\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nhicpro_regions &lt;- HiContactsData('yeast_wt', format = 'hicpro_bed')\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nhicprof &lt;- HicproFile(hicpro_matrix, bed = hicpro_regions)\nhicpro &lt;- import(hicprof)[\"II\"]\nhicpro\n##  `HiCExperiment` object with 523,301 contacts over 802 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/29210052806_7837\" \n##  focus: \"II\" \n##  resolutions(1): 1000\n##  active resolution: 1000 \n##  interactions: 70437 \n##  scores(1): count \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(1): regions\nhicpro &lt;- normalize(hicpro)\ncowplot::plot_grid(\n    plotMatrix(hicpro, use.scores = 'count'), \n    plotMatrix(hicpro, use.scores = 'ICE')\n)\n\n\n\n\n\n\n\n\n\nhic &lt;- import(\n    CoolFile(HiContactsData('yeast_wt', 'mcool')), \n    focus = 'II', \n    resolution = 2000\n)\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nhic_eco1 &lt;- import(\n    CoolFile(HiContactsData('yeast_eco1', 'mcool')), \n    focus = 'II', \n    resolution = 2000\n)\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\ndiv_contacts &lt;- divide(hic_eco1, by = hic) \n\ncowplot::plot_grid(\n    plotMatrix(hic_eco1, compare.to = hic, limits = c(-4, -1)), \n    plotMatrix(\n        div_contacts, \n        use.scores = 'balanced.fc', \n        scale = 'log2', \n        limits = c(-1, 1),\n        cmap = bwrColors()\n    )\n)\n\n\n\n\n\n\n\n\n\ndetrended_hic &lt;- detrend(hic)\ndetrended_hic\n##  `HiCExperiment` object with 471,364 contacts over 407 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"II\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 34063 \n##  scores(4): count balanced expected detrended \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\ncowplot::plot_grid(\n    plotMatrix(detrended_hic, use.scores = 'balanced', scale = 'log10', limits = c(-3.5, -1.2), caption = FALSE),\n    plotMatrix(detrended_hic, use.scores = 'expected', scale = 'log10', limits = c(-3.5, -1.2), caption = FALSE),\n    plotMatrix(detrended_hic, use.scores = 'detrended', scale = 'linear', limits = c(-1, 1), cmap = bwrColors(), caption = FALSE), \n    nrow = 1\n)\n\n\n\n\n\n\n\n\n\nautocorr_hic &lt;- autocorrelate(hic)\n##  \nautocorr_hic\n##  `HiCExperiment` object with 471,364 contacts over 407 regions \n##  -------\n##  fileName: \"/home/rsg/.cache/R/ExperimentHub/36d590c5583_7752\" \n##  focus: \"II\" \n##  resolutions(5): 1000 2000 4000 8000 16000\n##  active resolution: 2000 \n##  interactions: 34063 \n##  scores(5): count balanced expected detrended autocorrelated \n##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) \n##  pairsFile: N/A \n##  metadata(0):\ncowplot::plot_grid(\n    plotMatrix(autocorr_hic, use.scores = 'balanced', scale = 'log10', limits = c(-3.5, -1.2), caption = FALSE),\n    plotMatrix(autocorr_hic, use.scores = 'autocorrelated', scale = 'linear', limits = c(-0.4, 0.4), cmap = bwrColors(), caption = FALSE), \n    nrow = 1\n)"
  },
  {
    "objectID": "investigating.html#interactions-analysis",
    "href": "investigating.html#interactions-analysis",
    "title": "Investigating Hi-C data in R",
    "section": "",
    "text": "pairsf &lt;- HiContactsData('yeast_wt', 'pairs.gz')\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\npairsFile(hic) &lt;- pairsf\neco1_pairsf &lt;- HiContactsData('yeast_eco1', 'pairs.gz')\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\nhic_eco1 &lt;- PairsFile(eco1_pairsf)\n\n\nps &lt;- distanceLaw(hic, by_chr = TRUE) \n##  Importing pairs file /home/rsg/.cache/R/ExperimentHub/24a464c5ca2_7753 in memory. This may take a while...\nps_eco1 &lt;- distanceLaw(hic_eco1, by_chr = TRUE) \n##  Importing pairs file /home/rsg/.cache/R/ExperimentHub/6df72d47b9d_7755 in memory. This may take a while...\nps\n##  # A tibble: 115 × 6\n##    chr   binned_distance          p     norm_p norm_p_unity slope\n##    &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;\n##  1 II                 14 0.00000212 0.00000106         2.27  0   \n##  2 II                 16 0.0000170  0.0000170         36.4   1.56\n##  3 II                 17 0.0000361  0.0000180         38.6   1.55\n##  4 II                 19 0.0000424  0.0000212         45.5   1.55\n##  5 II                 21 0.0000467  0.0000233         50.0   1.54\n##  6 II                 23 0.0000870  0.0000290         62.1   1.53\n##  # ℹ 109 more rows\nps_eco1\n##  # A tibble: 115 × 6\n##    chr   binned_distance          p     norm_p norm_p_unity slope\n##    &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;\n##  1 II                 14 0.00000201 0.00000100        0.660  0   \n##  2 II                 16 0.0000221  0.0000221        14.5    1.46\n##  3 II                 17 0.0000492  0.0000246        16.2    1.46\n##  4 II                 19 0.0000412  0.0000206        13.5    1.45\n##  5 II                 21 0.0000653  0.0000326        21.5    1.45\n##  6 II                 23 0.0000803  0.0000268        17.6    1.44\n##  # ℹ 109 more rows\nlibrary(dplyr)\n##  \n##  Attaching package: 'dplyr'\n##  The following objects are masked from 'package:dbplyr':\n##  \n##      ident, sql\n##  The following objects are masked from 'package:BiocGenerics':\n##  \n##      combine, intersect, setdiff, union\n##  The following objects are masked from 'package:stats':\n##  \n##      filter, lag\n##  The following objects are masked from 'package:base':\n##  \n##      intersect, setdiff, setequal, union\nmerged_ps &lt;- rbind(\n    mutate(ps, sample = 'WT'), \n    mutate(ps_eco1, sample = 'eco1')\n)\nlibrary(ggplot2)\n##  \n##  Attaching package: 'ggplot2'\n##  The following object is masked from 'package:HiCExperiment':\n##  \n##      resolution\nplotPs(merged_ps, aes(x = binned_distance, y = norm_p, color = sample)) + \n    scale_color_manual(values = c('#c6c6c6', '#ca0000'))\n##  Warning: Removed 134 rows containing missing values (`geom_line()`).\n\n\n\n\n\n\nplotPsSlope(merged_ps, aes(x = binned_distance, y = slope, color = sample)) + \n    scale_color_manual(values = c('#c6c6c6', '#ca0000'))\n##  Warning: Removed 135 rows containing missing values (`geom_line()`).\n\n\n\n\n\n\n\n\n\nfull_hic &lt;- import(\n    CoolFile(HiContactsData('yeast_wt', 'mcool')), \n    resolution = 2000\n)\n##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation\n##  loading from cache\ncis_trans &lt;- cisTransRatio(full_hic) \ncis_trans\n##  # A tibble: 16 × 6\n##  # Groups:   chr [16]\n##    chr       cis  trans n_total cis_pct trans_pct\n##    &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;\n##  1 I      186326  96738  283064   0.658     0.342\n##  2 II     942728 273966 1216694   0.775     0.225\n##  3 III    303980 127087  431067   0.705     0.295\n##  4 IV    1858062 418218 2276280   0.816     0.184\n##  5 V      607090 220873  827963   0.733     0.267\n##  6 VI     280282 127771  408053   0.687     0.313\n##  # ℹ 10 more rows\n\n\n\nlibrary(GenomicRanges)\n##  Loading required package: stats4\n##  Loading required package: S4Vectors\n##  \n##  Attaching package: 'S4Vectors'\n##  The following objects are masked from 'package:dplyr':\n##  \n##      first, rename\n##  The following object is masked from 'package:HiCExperiment':\n##  \n##      metadata&lt;-\n##  The following object is masked from 'package:utils':\n##  \n##      findMatches\n##  The following objects are masked from 'package:base':\n##  \n##      expand.grid, I, unname\n##  Loading required package: IRanges\n##  \n##  Attaching package: 'IRanges'\n##  The following objects are masked from 'package:dplyr':\n##  \n##      collapse, desc, slice\n##  Loading required package: GenomeInfoDb\nv4C &lt;- virtual4C(full_hic, viewpoint = GRanges(\"II:230001-240000\"))\nv4C\n##  GRanges object with 6045 ranges and 4 metadata columns:\n##           seqnames        ranges strand |       score        viewpoint\n##              &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;numeric&gt;      &lt;character&gt;\n##       [1]        I        1-2000      * |  0.00000000 II:230001-240000\n##       [2]        I     2001-4000      * |  0.00000000 II:230001-240000\n##       [3]        I     4001-6000      * |  0.00129049 II:230001-240000\n##       [4]        I     6001-8000      * |  0.00000000 II:230001-240000\n##       [5]        I    8001-10000      * |  0.00000000 II:230001-240000\n##       ...      ...           ...    ... .         ...              ...\n##    [6041]      XVI 940001-942000      * | 0.000775721 II:230001-240000\n##    [6042]      XVI 942001-944000      * | 0.000000000 II:230001-240000\n##    [6043]      XVI 944001-946000      * | 0.000000000 II:230001-240000\n##    [6044]      XVI 946001-948000      * | 0.000000000 II:230001-240000\n##    [6045]      XVI 948001-948066      * | 0.000000000 II:230001-240000\n##              center in_viewpoint\n##           &lt;numeric&gt;    &lt;logical&gt;\n##       [1]    1000.5        FALSE\n##       [2]    3000.5        FALSE\n##       [3]    5000.5        FALSE\n##       [4]    7000.5        FALSE\n##       [5]    9000.5        FALSE\n##       ...       ...          ...\n##    [6041]    941000        FALSE\n##    [6042]    943000        FALSE\n##    [6043]    945000        FALSE\n##    [6044]    947000        FALSE\n##    [6045]    948034        FALSE\n##    -------\n##    seqinfo: 16 sequences from an unspecified genome; no seqlengths\nas_tibble(v4C) |&gt; \n    filter(seqnames == \"III\") |&gt; \n    ggplot(aes(x = center, y = score)) + \n    geom_line() + \n    labs(x = \"chr. III\", y = \"Contacts with viewpoint @ II:230001-240000\") +\n    scale_x_continuous(labels = scales::unit_format(unit = \"M\", scale = 1e-06))"
  },
  {
    "objectID": "investigating.html#read-more",
    "href": "investigating.html#read-more",
    "title": "Investigating Hi-C data in R",
    "section": "",
    "text": "Read the following sections from the OHCA book:\n\nMatrix-centric analyses in Hi-C\nInteraction-centric analyses in Hi-C"
  },
  {
    "objectID": "investigating.html#session-info",
    "href": "investigating.html#session-info",
    "title": "Investigating Hi-C data in R",
    "section": "",
    "text": "##  ─ Session info ────────────────────────────────────────────────────────────\n##   setting  value\n##   version  R version 4.3.0 (2023-04-21)\n##   os       Ubuntu 18.04.6 LTS\n##   system   x86_64, linux-gnu\n##   ui       X11\n##   language (EN)\n##   collate  en_US.UTF-8\n##   ctype    en_US.UTF-8\n##   tz       Europe/Paris\n##   date     2023-07-28\n##   pandoc   2.13 @ /usr/bin/ (via rmarkdown)\n##  \n##  ─ Packages ────────────────────────────────────────────────────────────────\n##   package                * version   date (UTC) lib source\n##   abind                    1.4-5     2016-07-21 [1] CRAN (R 4.3.0)\n##   AnnotationDbi            1.62.2    2023-07-02 [1] Bioconductor\n##   AnnotationHub          * 3.8.0     2023-04-25 [1] Bioconductor\n##   beeswarm                 0.4.0     2021-06-01 [1] CRAN (R 4.3.0)\n##   Biobase                  2.60.0    2023-04-25 [1] Bioconductor\n##   BiocFileCache          * 2.8.0     2023-04-25 [1] Bioconductor\n##   BiocGenerics           * 0.46.0    2023-04-25 [1] Bioconductor\n##   BiocIO                   1.10.0    2023-04-25 [1] Bioconductor\n##   BiocManager              1.30.21.1 2023-07-18 [1] CRAN (R 4.3.0)\n##   BiocParallel             1.34.2    2023-05-22 [1] Bioconductor\n##   BiocVersion              3.17.1    2022-11-04 [1] Bioconductor\n##   Biostrings               2.68.1    2023-05-16 [1] Bioconductor\n##   bit                      4.0.5     2022-11-15 [1] CRAN (R 4.3.0)\n##   bit64                    4.0.5     2020-08-30 [1] CRAN (R 4.3.0)\n##   bitops                   1.0-7     2021-04-24 [1] CRAN (R 4.3.0)\n##   blob                     1.2.4     2023-03-17 [1] CRAN (R 4.3.0)\n##   cachem                   1.0.8     2023-05-01 [1] CRAN (R 4.3.0)\n##   cli                      3.6.1     2023-03-23 [1] CRAN (R 4.3.0)\n##   codetools                0.2-19    2023-02-01 [1] CRAN (R 4.3.0)\n##   colorspace               2.1-0     2023-01-23 [1] CRAN (R 4.3.0)\n##   crayon                   1.5.2     2022-09-29 [1] CRAN (R 4.3.0)\n##   curl                     5.0.1     2023-06-07 [1] CRAN (R 4.3.0)\n##   DBI                      1.1.3     2022-06-18 [1] CRAN (R 4.3.0)\n##   dbplyr                 * 2.3.3     2023-07-07 [1] CRAN (R 4.3.0)\n##   DelayedArray             0.26.6    2023-07-02 [1] Bioconductor\n##   digest                   0.6.33    2023-07-07 [1] CRAN (R 4.3.0)\n##   dplyr                  * 1.1.2     2023-04-20 [1] CRAN (R 4.3.0)\n##   ellipsis                 0.3.2     2021-04-29 [1] CRAN (R 4.3.0)\n##   evaluate                 0.21      2023-05-05 [1] CRAN (R 4.3.0)\n##   ExperimentHub          * 2.8.1     2023-07-12 [1] Bioconductor\n##   fansi                    1.0.4     2023-01-22 [1] CRAN (R 4.3.0)\n##   farver                   2.1.1     2022-07-06 [1] CRAN (R 4.3.0)\n##   fastmap                  1.1.1     2023-02-24 [1] CRAN (R 4.3.0)\n##   filelock                 1.0.2     2018-10-05 [1] CRAN (R 4.3.0)\n##   generics                 0.1.3     2022-07-05 [1] CRAN (R 4.3.0)\n##   GenomeInfoDb           * 1.36.1    2023-06-21 [1] Bioconductor\n##   GenomeInfoDbData         1.2.10    2023-04-02 [1] Bioconductor\n##   GenomicRanges          * 1.52.0    2023-04-25 [1] Bioconductor\n##   ggbeeswarm               0.7.2     2023-04-29 [1] CRAN (R 4.3.0)\n##   ggplot2                * 3.4.2     2023-04-03 [1] CRAN (R 4.3.0)\n##   ggrastr                  1.0.2     2023-06-01 [1] CRAN (R 4.3.0)\n##   glue                     1.6.2     2022-02-24 [1] CRAN (R 4.3.0)\n##   gtable                   0.3.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   HiCExperiment          * 1.1.1     2023-07-27 [1] Github (js2264/HiCExperiment@9e8f7bb)\n##   HiContacts             * 1.3.1     2023-07-27 [1] Github (js2264/HiContacts@d3bdfef)\n##   HiContactsData         * 1.3.0     2023-05-26 [1] Github (js2264/HiContactsData@adcb51f)\n##   hms                      1.1.3     2023-03-21 [1] CRAN (R 4.3.0)\n##   htmltools                0.5.5     2023-03-23 [1] CRAN (R 4.3.0)\n##   htmlwidgets              1.6.2     2023-03-17 [1] CRAN (R 4.3.0)\n##   httpuv                   1.6.11    2023-05-11 [1] CRAN (R 4.3.0)\n##   httr                     1.4.6     2023-05-08 [1] CRAN (R 4.3.0)\n##   InteractionSet           1.29.1    2023-06-13 [1] Github (LTLA/InteractionSet@62cd50a)\n##   interactiveDisplayBase   1.38.0    2023-04-25 [1] Bioconductor\n##   IRanges                * 2.34.1    2023-06-22 [1] Bioconductor\n##   jsonlite                 1.8.7     2023-06-29 [1] CRAN (R 4.3.0)\n##   KEGGREST                 1.40.0    2023-04-25 [1] Bioconductor\n##   knitr                    1.43      2023-05-25 [1] CRAN (R 4.3.0)\n##   labeling                 0.4.2     2020-10-20 [1] CRAN (R 4.3.0)\n##   later                    1.3.1     2023-05-02 [1] CRAN (R 4.3.0)\n##   lattice                  0.21-8    2023-04-05 [1] CRAN (R 4.3.0)\n##   lifecycle                1.0.3     2022-10-07 [1] CRAN (R 4.3.0)\n##   magrittr                 2.0.3     2022-03-30 [1] CRAN (R 4.3.0)\n##   Matrix                   1.6-0     2023-07-08 [1] CRAN (R 4.3.0)\n##   MatrixGenerics           1.12.2    2023-06-09 [1] Bioconductor\n##   matrixStats              1.0.0     2023-06-02 [1] CRAN (R 4.3.0)\n##   memoise                  2.0.1     2021-11-26 [1] CRAN (R 4.3.0)\n##   mime                     0.12      2021-09-28 [1] CRAN (R 4.3.0)\n##   munsell                  0.5.0     2018-06-12 [1] CRAN (R 4.3.0)\n##   pillar                   1.9.0     2023-03-22 [1] CRAN (R 4.3.0)\n##   pkgconfig                2.0.3     2019-09-22 [1] CRAN (R 4.3.0)\n##   png                      0.1-8     2022-11-29 [1] CRAN (R 4.3.0)\n##   promises                 1.2.0.1   2021-02-11 [1] CRAN (R 4.3.0)\n##   purrr                    1.0.1     2023-01-10 [1] CRAN (R 4.3.0)\n##   R6                       2.5.1     2021-08-19 [1] CRAN (R 4.3.0)\n##   rappdirs                 0.3.3     2021-01-31 [1] CRAN (R 4.3.0)\n##   Rcpp                     1.0.11    2023-07-06 [1] CRAN (R 4.3.0)\n##   RCurl                    1.98-1.12 2023-03-27 [1] CRAN (R 4.3.0)\n##   readr                    2.1.4     2023-02-10 [1] CRAN (R 4.3.0)\n##   rhdf5                    2.44.0    2023-04-25 [1] Bioconductor\n##   rhdf5filters             1.12.1    2023-04-30 [1] Bioconductor\n##   Rhdf5lib                 1.22.0    2023-04-25 [1] Bioconductor\n##   rlang                    1.1.1     2023-04-28 [1] CRAN (R 4.3.0)\n##   rmarkdown                2.23      2023-07-01 [1] CRAN (R 4.3.0)\n##   RSpectra                 0.16-1    2022-04-24 [1] CRAN (R 4.3.0)\n##   RSQLite                  2.3.1     2023-04-03 [1] CRAN (R 4.3.0)\n##   rstudioapi               0.15.0    2023-07-07 [1] CRAN (R 4.3.0)\n##   S4Arrays                 1.0.5     2023-07-24 [1] Bioconductor\n##   S4Vectors              * 0.38.1    2023-05-02 [1] Bioconductor\n##   scales                   1.2.1     2022-08-20 [1] CRAN (R 4.3.0)\n##   sessioninfo              1.2.2     2021-12-06 [1] CRAN (R 4.3.0)\n##   shiny                    1.7.4.1   2023-07-06 [1] CRAN (R 4.3.0)\n##   strawr                   0.0.91    2023-03-29 [1] CRAN (R 4.3.0)\n##   stringi                  1.7.12    2023-01-11 [1] CRAN (R 4.3.0)\n##   stringr                  1.5.0     2022-12-02 [1] CRAN (R 4.3.0)\n##   SummarizedExperiment     1.30.2    2023-06-06 [1] Bioconductor\n##   tibble                   3.2.1     2023-03-20 [1] CRAN (R 4.3.0)\n##   tidyr                    1.3.0     2023-01-24 [1] CRAN (R 4.3.0)\n##   tidyselect               1.2.0     2022-10-10 [1] CRAN (R 4.3.0)\n##   tzdb                     0.4.0     2023-05-12 [1] CRAN (R 4.3.0)\n##   utf8                     1.2.3     2023-01-31 [1] CRAN (R 4.3.0)\n##   vctrs                    0.6.3     2023-06-14 [1] CRAN (R 4.3.0)\n##   vipor                    0.4.5     2017-03-22 [1] CRAN (R 4.3.0)\n##   vroom                    1.6.3     2023-04-28 [1] CRAN (R 4.3.0)\n##   withr                    2.5.0     2022-03-03 [1] CRAN (R 4.3.0)\n##   xfun                     0.39      2023-04-20 [1] CRAN (R 4.3.0)\n##   xtable                   1.8-4     2019-04-21 [1] CRAN (R 4.3.0)\n##   XVector                  0.40.0    2023-04-25 [1] Bioconductor\n##   yaml                     2.3.7     2023-01-23 [1] CRAN (R 4.3.0)\n##   zlibbioc                 1.46.0    2023-04-25 [1] Bioconductor\n##  \n##   [1] /home/rsg/R/x86_64-pc-linux-gnu-library/4.3\n##   [2] /usr/local/lib/R-4.3/lib/R/library\n##  \n##  ───────────────────────────────────────────────────────────────────────────"
  }
]